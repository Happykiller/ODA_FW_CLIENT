var $;!function($){if($.fn.exists=function(){return this.length>0},$.fn.btEnable=function(){this.removeClass("disabled"),this.removeAttr("disabled")},$.fn.btDisable=function(){this.hasClass("disabled")||this.addClass("disabled"),this.attr("disabled",!0)},"function"!=typeof CustomEvent){var CustomEvent;CustomEvent=function(event,params){var evt;return params=params||{bubbles:!1,cancelable:!1,detail:void 0},evt=document.createEvent("CustomEvent"),evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail),evt},CustomEvent.prototype=window.Event.prototype,window.CustomEvent=CustomEvent}String.prototype.startsWith||(String.prototype.startsWith=function(searchString,position){return position=position||0,this.indexOf(searchString,position)===position}),String.prototype.includes||(String.prototype.includes=function(searchString,position){return this.indexOf(searchString,position)>=0}),Object.prototype.watch||Object.defineProperty(Object.prototype,"watch",{enumerable:!1,configurable:!0,writable:!1,value:function(prop,handler){var oldval=this[prop],newval=oldval,getter=function(){return newval},setter=function(val){return oldval=newval,newval=handler.call(this,prop,oldval,val)};delete this[prop]&&Object.defineProperty(this,prop,{get:getter,set:setter,enumerable:!0,configurable:!0})}}),Object.prototype.unwatch||Object.defineProperty(Object.prototype,"unwatch",{enumerable:!1,configurable:!0,writable:!1,value:function(prop){var val=this[prop];delete this[prop],this[prop]=val}});var VERSION="0.170303.00";$.Oda={version:"0.170303.00",Session:null,SessionDefault:{code_user:"",key:"",id:0,userInfo:{locale:"en",firstName:"",lastName:"",mail:"",profile:0,profileLabel:"",showTooltip:0}},Context:{modeInterface:["cache","ajax","mokup","offline"],ModeExecution:{init:!1,scene:!1,notification:!1,message:!1,rooter:!1,app:!1,footer:!1},debug:!1,dev:!1,appLibName:!1,vendorName:"bower_components",rootPath:"",projectLabel:"Project",mainDiv:"oda-content",host:"",rest:"",resources:"resources/",window:window,console:console,startDate:!1},Regexs:{mail:"[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+(?:[A-Z]{2}|com|org|net|edu|gov|mil|biz|info|mobi|name|aero|asia|jobs|museum|fr)\\b",login:"^[a-zA-Z0-9]{3,}$",pass:"^[a-zA-Z0-9]{4,}$",firstName:"^[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð ,.'-]{3,}$",lastName:"^[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð ,.'-]{3,}$",noInjection:"^(?!.*?function())"},init:function(){try{window.CKEDITOR_BASEPATH=$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/ckeditor/",$.Oda.Session.userInfo.locale=$.Oda.Tooling.getLangBrowser();var listDepends=[{name:"library",ordered:!1,list:[{elt:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/i8n/i8n.json",type:"json",target:function(p_json){$.Oda.I8n.datas=$.Oda.I8n.datas.concat(p_json)}},{elt:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/css/css.css",type:"css"},{elt:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/templates/Oda.html",type:"html",target:function(data){$("body").append(data)}}]}];if($.Oda.Tooling.isInArray("mokup",$.Oda.Context.modeInterface)){var listDependsMokup=[{name:"mokup",ordered:!1,list:[{elt:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/mokup/mokup.json",type:"json",target:function(p_json){$.Oda.MokUp.mokup=$.Oda.MokUp.mokup.concat(p_json)}}]}];listDepends=listDepends.concat(listDependsMokup)}if($.Oda.Tooling.isInArray("cache",$.Oda.Context.modeInterface)){var listDependsCache=[{name:"cache",ordered:!1,list:[{elt:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/cache/cache.json",type:"json",target:function(p_json){$.Oda.Cache.config=$.Oda.Cache.config.concat(p_json)}}]}];listDepends=listDepends.concat(listDependsCache)}if($.Oda.Context.ModeExecution.app){var libName="OdaApp.js";!$.Oda.Context.dev&&$.Oda.Context.appLibName&&(libName=$.Oda.Context.appLibName);var listDependsApp=[{name:"app",ordered:!1,list:[{elt:$.Oda.Context.rootPath+"config/config.js",type:"script"},{elt:$.Oda.Context.rootPath+"css/css.css",type:"css"},{elt:$.Oda.Context.rootPath+"i8n/i8n.json",type:"json",target:function(p_json){$.Oda.I8n.datas=$.Oda.I8n.datas.concat(p_json)}},{elt:$.Oda.Context.rootPath+"js/"+libName,type:"script"}]}];if($.Oda.Tooling.isInArray("mokup",$.Oda.Context.modeInterface)){var listDependsMokupApp=[{name:"mokupApp",ordered:!1,list:[{elt:$.Oda.Context.rootPath+"mokup/mokup.json",type:"json",target:function(p_json){$.Oda.MokUp.mokup=$.Oda.MokUp.mokup.concat(p_json)}}]}];listDepends=listDepends.concat(listDependsMokupApp)}if($.Oda.Tooling.isInArray("cache",$.Oda.Context.modeInterface)){var listDependsCacheApp=[{name:"cacheApp",ordered:!1,list:[{elt:$.Oda.Context.rootPath+"cache/cache.json",type:"json",target:function(p_json){$.Oda.Cache.config=$.Oda.Cache.config.concat(p_json)}}]}];listDepends=listDepends.concat(listDependsCacheApp)}listDepends=listDepends.concat(listDependsApp)}if($.Oda.Context.ModeExecution.widget&&$.Oda.Display.Widget.load(),$.Oda.Context.ModeExecution.scene){$.Oda.Router.routesAllowedDefault=["","home","contact","forgot","subscrib","profile","resetPwd"],$.Oda.Router.routesAllowed=$.Oda.Router.routesAllowedDefault.slice(0),$.Oda.Router.addMiddleWare("support",function(){$.Oda.Log.debug("MiddleWares : support"),$.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/sys/param/maintenance",{callback:function(response){try{"1"===response.data.param_value&&($.Oda.Router.routerExit=!0,$.Oda.Router.routes.support.go())}catch(e){$.Oda.Router.routerExit=!0,$.Oda.Router.routes.support.go()}}})}),$.Oda.Router.addMiddleWare("auth",function(){if($.Oda.Log.debug("MiddleWares : auth"),$.Oda.Session.hasOwnProperty("code_user")&&""!==$.Oda.Session.code_user)$.Oda.Tooling.isInArray($.Oda.Router.current.route,$.Oda.Router.routesAllowed)?$.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/session/check",{callback:function(data){data.data||($.Oda.Router.routerExit=!0,$.Oda.Security.logout())}},{code_user:$.Oda.Session.code_user,key:$.Oda.Session.key}):($.Oda.Log.error("MiddleWares auth : route not allowed "+$.Oda.Router.current.route),$.Oda.Router.routerExit=!0,$.Oda.Security.logout());else{var session=$.Oda.Storage.get("ODA-SESSION");if(null!==session)$.Oda.Session=session,$.Oda.I8n.watchLanguage(),$.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/session/check",{callback:function(data){data.data?$.Oda.Security.loadRight({callback:function(){$.Oda.Tooling.isInArray($.Oda.Router.current.route,$.Oda.Router.routesAllowed)||($.Oda.Router.routerExit=!0,$.Oda.Security.logout())}}):($.Oda.Router.routerExit=!0,$.Oda.Security.logout())}},{code_user:session.code_user,key:session.key});else{var params=$.Oda.Router.current.args;if(params.hasOwnProperty("getUser")&&params.hasOwnProperty("getPass")){$.Oda.Security.auth({login:params.getUser,mdp:params.getPass,reload:!1})?$.Oda.Tooling.isInArray($.Oda.Router.current.route,$.Oda.Router.routesAllowed)||($.Oda.Router.routerExit=!0,$.Oda.Security.logout()):($.Oda.Router.routerExit=!0,$.Oda.Security.logout())}else $.Oda.Router.routerExit=!0,$.Oda.Security.logout()}}}),$.Oda.Router.addDependencies("hightcharts",{ordered:!0,list:[{elt:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/highcharts-release/highcharts.js",type:"script"},{elt:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/highcharts-release/modules/exporting.js",type:"script"}]}),$.Oda.Router.addDependencies("dataTables",{ordered:!0,list:[{elt:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/datatables/media/js/jquery.dataTables.min.js",type:"script"},{elt:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/css/dataTables.bootstrap.css",type:"css"},{elt:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/js/dataTables/dataTables.bootstrap.js",type:"script"}]}),$.Oda.Router.addDependencies("ckeditor",{ordered:!1,list:[{elt:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/ckeditor/ckeditor.js",type:"script"}]}),$.Oda.Router.addRoute("auth",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/auth.html",title:"oda-main.authentification",urls:["auth"],middleWares:["support"],system:!0}),$.Oda.Router.addRoute("support",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/support.html",title:"oda-main.support-title",urls:["support"],system:!0}),$.Oda.Router.addRoute("404",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/404.html",title:"oda-main.404-title",urls:["404"],system:!0}),$.Oda.Router.addRoute("resetPwd",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/resetPwd.html",title:"resetPwd.title",urls:["resetPwd"],middleWares:["support"]}),$.Oda.Router.addRoute("contact",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/contact.html",title:"oda-main.contact",urls:["contact"],middleWares:["support"]}),$.Oda.Router.addRoute("forgot",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/forgot.html",title:"oda-main.forgot-title",urls:["forgot"],middleWares:["support"]}),$.Oda.Router.addRoute("subscrib",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/subscrib.html",title:"oda-main.subscrib-title",urls:["subscrib"],middleWares:["support"]}),$.Oda.Router.addRoute("home",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/home.html",title:"oda-main.home-title",urls:["","home"],middleWares:["support","auth"]}),$.Oda.Router.addRoute("profile",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/profile.html",title:"oda-main.profile-title",urls:["profile"],middleWares:["support","auth"]}),$.Oda.Router.addRoute("stats",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/stats.html",title:"oda-stats.title",urls:["stats"],middleWares:["support","auth"],dependencies:["hightcharts"]}),$.Oda.Router.addRoute("admin",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/admin.html",title:"oda-admin.title",urls:["admin"],middleWares:["support","auth"],dependencies:["dataTables","ckeditor"]}),$.Oda.Router.addRoute("supervision",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/supervision.html",title:"oda-supervision.title",urls:["supervision"],middleWares:["support","auth"],dependencies:["dataTables"]}),$.Oda.Router.addRoute("tests",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/tests.html",title:"oda-tests.title",urls:["tests"],middleWares:["support","auth"]}),$.Oda.Router.addRoute("navigation",{path:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/partials/navigation.html",title:"oda-navigation.title",urls:["navigation"],middleWares:["support","auth"],dependencies:["dataTables"]});var listDependsScene=[{name:"scene",ordered:!1,list:[{elt:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/css/simple-sidebar.css",type:"css"},{elt:$.Oda.Context.rootPath+$.Oda.Context.vendorName+"/Oda/resources/templates/Scene.html",type:"html",target:function(data){$("body").append(data)}}]}];listDepends=listDepends.concat(listDependsScene)}return $.Oda.Loader.load({depends:listDepends,functionFeedback:function(data){$.Oda.Context.ModeExecution.footer&&$("body").append('<div class="footer">Power with <a href="http://oda.happykiller.net" target="_blank">Oda</a></div>'),""!==$.Oda.Context.host&&($.Oda.Storage.storageKey="ODA__"+$.Oda.Context.host+"__"),$.Oda.Context.ModeExecution.notification&&$.Oda.Display.Notification.load(),$.Oda.Context.ModeExecution.scene&&($("#"+$.Oda.Context.mainDiv).exists()&&$("#"+$.Oda.Context.mainDiv).remove(),$.Oda.Display.Scene.load()),$.Oda.Context.ModeExecution.rooter&&$.Oda.Router.startRooter();var d=new Date,mili=(d.getTime(),d-$.Oda.Context.startDate.getTime());$.Oda.Log.info("Oda fully loaded. (in "+mili+" miliseconds)"),$.Oda.Event.send({name:"oda-fully-loaded",data:{truc:data.msg}})},functionFeedbackParams:{msg:"Welcome with Oda"}}),this}catch(er){return $.Oda.Log.error("$.Oda.init : "+er.message),null}},Controller:{},App:{},Cache:{config:[],cache:[],save:function(p_params){try{if(""!==$.Oda.Session.code_user){var founded=!1;for(var indice in $.Oda.Cache.config){var elt=$.Oda.Cache.config[indice];if(p_params.key.includes(elt.key)){founded=!0;break}}if(founded){$.Oda.Cache.cache=$.Oda.Storage.get("ODA-CACHE-"+$.Oda.Session.code_user,$.Oda.Cache.cache);var d=new Date,date=d.getTime();p_params.recordDate=date;for(var indice in $.Oda.Cache.cache){var elt=$.Oda.Cache.cache[indice];elt.key===p_params.key&&$.Oda.Tooling.deepEqual(elt.attrs,p_params.attrs)&&$.Oda.Cache.cache.splice(indice,1)}return $.Oda.Cache.cache.push(p_params),$.Oda.Storage.set("ODA-CACHE-"+$.Oda.Session.code_user,$.Oda.Cache.cache),this}return this}return this}catch(er){return $.Oda.Log.error("$.Oda.Cache.save : "+er.message),null}},load:function(p_params){try{if(""!==$.Oda.Session.code_user){var eltConfig,founded=!1;for(var indice in $.Oda.Cache.config)if(eltConfig=$.Oda.Cache.config[indice],p_params.key.includes(eltConfig.key)){if(eltConfig.hasOwnProperty("onDemande")&&eltConfig.onDemande&&p_params.demande){founded=!0;break}if(eltConfig.hasOwnProperty("onDemande")&&!1===eltConfig.onDemande||!eltConfig.hasOwnProperty("onDemande")){founded=!0;break}}if(founded){$.Oda.Cache.cache=$.Oda.Storage.get("ODA-CACHE-"+$.Oda.Session.code_user,$.Oda.Cache.cache);for(var indice in $.Oda.Cache.cache){var elt=$.Oda.Cache.cache[indice];if(elt.key===p_params.key&&$.Oda.Tooling.deepEqual(elt.attrs,p_params.attrs)){if(0!==eltConfig.ttl){return!((new Date).getTime()>elt.recordDate+1e3*eltConfig.ttl)&&elt}return elt}}}return!1}return!1}catch(er){return $.Oda.Log.error("$.Oda.Cache.load : "+er.message),null}},loadWithOutTtl:function(p_params){try{if(""!==$.Oda.Session.code_user){var founded=!1;for(var indice in $.Oda.Cache.config){var elt=$.Oda.Cache.config[indice];if(p_params.key.includes(elt.key)){founded=!0;break}}if(founded){$.Oda.Cache.cache=$.Oda.Storage.get("ODA-CACHE-"+$.Oda.Session.code_user,$.Oda.Cache.cache);for(var indice in $.Oda.Cache.cache){var elt=$.Oda.Cache.cache[indice];if(elt.key===p_params.key&&$.Oda.Tooling.deepEqual(elt.attrs,p_params.attrs))return elt}}return!1}return!1}catch(er){return $.Oda.Log.error("$.Oda.Cache.loadWithOutTtl : "+er.message),null}},remove:function(p_params){try{$.Oda.Cache.cache=$.Oda.Storage.get("ODA-CACHE-"+$.Oda.Session.code_user,$.Oda.Cache.cache);for(var indice in $.Oda.Cache.cache){var elt=$.Oda.Cache.cache[indice];if(elt.key===p_params.key&&$.Oda.Tooling.deepEqual(elt.attrs,p_params.attrs)){$.Oda.Cache.cache.splice(indice,1);break}}return $.Oda.Storage.set("ODA-CACHE-"+$.Oda.Session.code_user,$.Oda.Cache.cache),this}catch(er){return $.Oda.Log.error("$.Oda.Cache.remove : "+er.message),null}},clean:function(){try{return""!==$.Oda.Session.code_user&&$.Oda.Storage.remove("ODA-CACHE-"+$.Oda.Session.code_user),this}catch(er){return $.Oda.Log.error("$.Oda.Cache.clean : "+er.message),null}},cleanAll:function(){try{var listCache=$.Oda.Storage.getIndex("ODA-CACHE");for(var indice in listCache){var key=$.Oda.Tooling.replaceAll({str:listCache[indice],find:$.Oda.Storage.storageKey,by:""});$.Oda.Storage.remove(key)}return this}catch(er){return $.Oda.Log.error("$.Oda.Cache.cleanAll : "+er.message),null}}},Loader:{Status:{init:0,loading:1,loaded:2,fail:3},iterator:0,buffer:[],eltAlreadyLoad:{},load:function(params){try{var eltLoader=params;eltLoader.id=$.Oda.Loader.iterator;for(var indiceGrp in eltLoader.depends){var grp=eltLoader.depends[indiceGrp];grp.state=$.Oda.Loader.Status.init;for(var indiceElt in grp.list){grp.list[indiceElt].state=$.Oda.Loader.Status.init}}return $.Oda.Loader.buffer.push(eltLoader),$.Oda.Loader.iterator++,$.Oda.Loader.loading({id:eltLoader.id}),this}catch(er){$.Oda.Log.error("$.Oda.Loader.load : "+er.message)}},loading:function(p_params){try{var eltLoader=$.Oda.Loader.buffer[p_params.id];for(var indiceGrp in eltLoader.depends){var grp=eltLoader.depends[indiceGrp];if(grp.state===$.Oda.Loader.Status.init)return $.Oda.Log.debug("Dependency group loading : "+grp.name),grp.state=$.Oda.Loader.Status.loading,$.Oda.Event.addListener({name:"oda-loader-"+p_params.id+"-"+grp.name,callback:function(e){return $.Oda.Loader.loading({id:e.detail.idLoader}),this}}),$.Oda.Loader.loadingGrp({idLoader:p_params.id,grp:grp}),this}return eltLoader.hasOwnProperty("functionFeedback")&&(eltLoader.hasOwnProperty("functionFeedbackParams")?eltLoader.functionFeedback(eltLoader.functionFeedbackParams):eltLoader.functionFeedback()),this}catch(er){return $.Oda.Log.error("$.Oda.Loader.loading : "+er.message),null}},loadingGrp:function(p_params){try{var statutGrp=$.Oda.Loader.Status.loaded;for(var indiceElt in p_params.grp.list){var elt=p_params.grp.list[indiceElt];if(elt.state===$.Oda.Loader.Status.init){if($.Oda.Log.debug("Dependency element loading : "+elt.elt+" of grp : "+p_params.grp.name),elt.state=$.Oda.Loader.Status.loading,$.Oda.Event.addListener({name:"oda-loader-"+p_params.idLoader+"-"+p_params.grp.name+"-"+elt.elt,callback:function(e){return $.Oda.Loader.loadingGrp({idLoader:e.detail.idLoader,grp:e.detail.grp}),this}}),$.Oda.Loader.loadingElt({idLoader:p_params.idLoader,grp:p_params.grp,elt:elt}),p_params.grp.ordered)return this}else elt.state===$.Oda.Loader.Status.fail&&(statutGrp=$.Oda.Loader.Status.fail)}if(!p_params.grp.ordered)for(var indiceElt in p_params.grp.list){var elt=p_params.grp.list[indiceElt];if(elt.state===$.Oda.Loader.Status.loading)return this}return p_params.grp.state!==$.Oda.Loader.Status.loaded&&(p_params.grp.state=statutGrp,$.Oda.Log.debug("Dependency group loaded : "+p_params.grp.name+" with code : "+p_params.grp.state),$.Oda.Event.send({name:"oda-loader-"+p_params.idLoader+"-"+p_params.grp.name,data:{grpName:p_params.grp.name,idLoader:p_params.idLoader,grpState:statutGrp}})),this}catch(er){return $.Oda.Log.error("$.Oda.Loader.loadingGrp : "+er.message),null}},loadingElt:function(p_params){try{if(p_params.elt.state!==$.Oda.Loader.Status.loaded)if(p_params.elt.hasOwnProperty("force")||(p_params.elt.force=!1),$.Oda.Loader.eltAlreadyLoad.hasOwnProperty(p_params.elt.elt)&&$.Oda.Loader.eltAlreadyLoad[p_params.elt.elt]===$.Oda.Loader.Status.loaded&&!1===p_params.elt.force)p_params.elt.state=$.Oda.Loader.Status.loaded,$.Oda.Log.debug("Dependency element already loaded : "+p_params.elt.elt+" of grp : "+p_params.grp.name+" of  with code : "+p_params.elt.state),$.Oda.Event.send({name:"oda-loader-"+p_params.idLoader+"-"+p_params.grp.name+"-"+p_params.elt.elt,data:{grp:p_params.grp,idLoader:p_params.idLoader}});else switch(p_params.elt.type){case"css":$("<link/>",{rel:"stylesheet",type:"text/css",href:p_params.elt.elt}).appendTo("head"),$.Oda.Loader.eltAlreadyLoad[p_params.elt.elt]=$.Oda.Loader.Status.loaded,p_params.elt.state=$.Oda.Loader.Status.loaded,$.Oda.Log.debug("Dependency element loaded : "+p_params.elt.elt+" of grp : "+p_params.grp.name+" of  with code : "+p_params.elt.state),$.Oda.Event.send({name:"oda-loader-"+p_params.idLoader+"-"+p_params.grp.name+"-"+p_params.elt.elt,data:{grp:p_params.grp,idLoader:p_params.idLoader}});break;case"script":case"json":case"html":$.ajax({url:p_params.elt.elt,dataType:p_params.elt.type,context:{params:p_params},success:function(data,textStatus,jqxhr){var params=$(this)[0].params;params.elt.hasOwnProperty("target")&&params.elt.target(data),$.Oda.Loader.eltAlreadyLoad[params.elt.elt]=$.Oda.Loader.Status.loaded,params.elt.state=$.Oda.Loader.Status.loaded,$.Oda.Log.debug("Dependency element loaded : "+params.elt.elt+" of grp : "+params.grp.name+" of  with code : "+params.elt.state),$.Oda.Event.send({name:"oda-loader-"+params.idLoader+"-"+params.grp.name+"-"+params.elt.elt,data:{grp:params.grp,idLoader:params.idLoader}})},error:function(jqxhr,settings,exception){var params=$(this)[0].params;$.Oda.Loader.eltAlreadyLoad[params.elt.elt]=$.Oda.Loader.Status.fail,params.elt.state=$.Oda.Loader.Status.fail,$.Oda.Log.debug("Dependency element fail : "+params.elt.elt+" of grp : "+params.grp.name+" of  with code : "+params.elt.state),$.Oda.Event.send({name:"oda-loader-"+params.idLoader+"-"+params.grp.name+"-"+params.elt.elt,data:{grp:params.grp,idLoader:params.idLoader}})}});break;default:$.Oda.Log.debug("Type unknown for : "+p_params.elt.elt+".")}return this}catch(er){return $.Oda.Log.error("$.Oda.Loader.loadingElt : "+er.message),null}}},Mobile:{funcReturnGPSPosition:null,funcReturnCaptureImg:null,networkState:null,positionGps:{coords:{latitude:0,longitude:0,altitude:0,accuracy:0,altitudeAccuracy:0,heading:0,speed:0},timestamp:0,statut:""},pictureSource:null,destinationType:null,onMobile:!1,onMobileTest:!1,onSuccessGPSPosition:function(p_position){try{$.Oda.Mobile.positionGps.coords=p_position.coords,$.Oda.Mobile.positionGps.timestamp=p_position.timestamp,$.Oda.Mobile.positionGps.statut="OK",$.Oda.Mobile.funcReturnGPSPosition($.Oda.Mobile.positionGps)}catch(er){$.Oda.Log.error("$.Oda.Mobile.onSuccessGPSPosition: "+er.message)}},onErrorGPSPosition:function(p_error){try{$.Oda.Mobile.positionGps.statut="KO : code=>"+p_error.code+", message=>"+p_error.message,$.Oda.Mobile.funcReturnGPSPosition($.Oda.Mobile.positionGps)}catch(er){$.Oda.Log.error("$.Oda.Mobile.onErrorGPSPosition: "+er.message)}},onPhotoSuccess:function(p_imageData){try{var imgSrc="data:image/jpeg;base64,"+p_imageData;$.Oda.Mobile.funcReturnCaptureImg(imgSrc)}catch(er){$.Oda.Log.error("$.Oda.Mobile.onPhotoSuccess: "+er.message)}},onPhotoURISuccess:function(p_imageURI){try{var imgSrc=p_imageURI;$.Oda.Mobile.funcReturnCaptureImg(imgSrc)}catch(er){$.Oda.Log.error("$.Oda.Mobile.onPhotoURISuccess: "+er.message)}},onPhotoFail:function(p_message){try{alert("Failed because: "+p_message)}catch(er){$.Oda.Log.error("$.Oda.Mobile.onPhotoFail: "+er.message)}},initModuleMobile:function(){try{return $.Oda.Mobile.networkState=navigator.connection.type,$.Oda.Mobile.pictureSource=navigator.camera.PictureSourceType,$.Oda.Mobile.destinationType=navigator.camera.DestinationType,!0}catch(er){return $.Oda.Log.error("$.Oda.Mobile.initModuleMobile: "+er.message),null}},getConnectionString:function(p_networkState){try{var states={};return states[Connection.UNKNOWN]="Unknown connection",states[Connection.ETHERNET]="Ethernet connection",states[Connection.WIFI]="WiFi connection",states[Connection.CELL_2G]="Cell 2G connection",states[Connection.CELL_3G]="Cell 3G connection",states[Connection.CELL_4G]="Cell 4G connection",states[Connection.NONE]="No network connection","Connection type: "+states[p_networkState]}catch(er){return $.Oda.Log.error("$.Oda.Mobile.getConnectionString: "+er.message),null}},testConnection:function(){try{return alert(this.getConnectionString(_networkState)),!0}catch(er){return $.Oda.Log.error("$.Oda.Mobile.testConnection: "+er.message),null}},getGpsPosition:function(p_onReturn){try{return $.Oda.Mobile.funcReturnGPSPosition=p_onReturn,navigator.geolocation.getCurrentPosition(_onSuccessGPSPosition,_onErrorGPSPosition),!0}catch(er){return $.Oda.Log.error("$.Oda.Mobile.getGpsPosition: "+er.message),null}},getGpsPositionString:function(p_position){try{var retour="";return retour+="Latitude: "+p_position.coords.latitude+"\nLongitude: "+p_position.coords.longitude+"\nAltitude: "+p_position.coords.altitude+"\nAccuracy: "+p_position.coords.accuracy+"\nAltitude Accuracy: "+p_position.coords.altitudeAccuracy+"\nHeading: "+p_position.coords.heading+"\nSpeed: "+p_position.coords.speed+"\nTimestamp: "+p_position.timestamp+"\nstatut: "+p_position.statut+"\n"}catch(er){return $.Oda.Log.error("$.Oda.Mobile.getGpsPositionString: "+er.message),null}},getPhotoFromCamera:function(p_retourCapture){try{return $.Oda.Mobile.funcReturnCaptureImg=p_retourCapture,navigator.camera.getPicture(_onPhotoSuccess,_onPhotoFail,{quality:50,destinationType:_destinationType.DATA_URL}),!0}catch(er){return $.Oda.Log.error("$.Oda.Mobile.getPhotoFromCamera: "+er.message),null}},getPhotoFromLibrary:function(p_retourCapture){try{return $.Oda.Mobile.funcReturnCaptureImg=p_retourCapture,navigator.camera.getPicture(_onPhotoURISuccess,_onPhotoFail,{quality:50,destinationType:_destinationType.FILE_URI,sourceType:_pictureSource.PHOTOLIBRARY}),!0}catch(er){return $.Oda.Log.error("$.Oda.Mobile.getPhotoFromLibrary: "+er.message),null}}},MokUp:{mokup:[],get:function(params){try{var elt,strInterface=params.url.replace($.Oda.Context.rest,"");for(var indice in $.Oda.MokUp.mokup)if(params.url.includes($.Oda.MokUp.mokup[indice].interface)){elt=$.Oda.MokUp.mokup[indice];break}var defaultValue={strErreur:"No mokup found for "+strInterface,data:{},statut:4},value=null;if($.Oda.Tooling.isUndefined(elt))return defaultValue;var attrs=$.Oda.Tooling.clone(params.tabInput);attrs.hasOwnProperty("ctrl")&&delete attrs.ctrl,attrs.hasOwnProperty("milis")&&delete attrs.milis,attrs.hasOwnProperty("keyAuthODA")&&delete attrs.keyAuthODA;for(var indice in elt.value){var valuePossible=elt.value[indice];if("default"===valuePossible.args&&(defaultValue=valuePossible.return),$.Oda.Tooling.deepEqual(valuePossible.args,attrs)){value=valuePossible.return;break}}return null===value?defaultValue:value}catch(er){return $.Oda.Log.error("$.Oda.MokUp.get : "+er.message),null}}},Event:{addListener:function(p_params){try{return $.Oda.Context.window.addEventListener(p_params.name,p_params.callback,!1),this}catch(er){return $.Oda.Log.error("$.Oda.Event.addListener : "+er.message),null}},send:function(p_params){try{p_params.hasOwnProperty("data")||(p_params.data={});var event=new CustomEvent(p_params.name,{detail:p_params.data});return $.Oda.Context.window.dispatchEvent(event),this}catch(er){return $.Oda.Log.error("$.Oda.Event.send : "+er.message),null}}},Date:{getStrDateFR:function(){try{var currentTime=new Date,annee=currentTime.getFullYear(),mois=$.Oda.Tooling.pad2(currentTime.getMonth()+1);return $.Oda.Tooling.pad2(currentTime.getDate())+"/"+mois+"/"+annee}catch(er){return $.Oda.Log.error("$.Oda.Date.getStrDateFR() : "+er.message),null}},getStrDateTimeFrFromUs:function(p_strDateTime){try{return p_strDateTime.substr(8,2)+"/"+p_strDateTime.substr(5,2)+"/"+p_strDateTime.substr(0,4)+" "+p_strDateTime.substr(10,p_strDateTime.length-10)}catch(er){return $.Oda.Log.error("$.Oda.Date.getStrDateTimeFrFromUs : "+er.message),null}},getStrDateFrFromUs:function(p_strDate){try{return p_strDate.substr(8,2)+"/"+p_strDate.substr(5,2)+"/"+p_strDate.substr(0,4)}catch(er){return $.Oda.Log.error("$.Oda.Date.getStrDateFrFromUs : "+er.message),null}},convertSecondsToTime:function(p_second){try{var sec_num=p_second,hours=Math.floor(sec_num/3600),minutes=Math.floor((sec_num-3600*hours)/60),seconds=sec_num-3600*hours-60*minutes;hours<10&&(hours="0"+hours),minutes<10&&(minutes="0"+minutes),seconds<10&&(seconds="0"+seconds);return hours+":"+minutes+":"+seconds}catch(er){return $.Oda.Log.error("$.Oda.Date.convertSecondsToTime : "+er.message),null}},getStrDateTime:function(){try{var currentTime=new Date,hours=$.Oda.Tooling.pad2(currentTime.getHours()),minutes=$.Oda.Tooling.pad2(currentTime.getMinutes());return currentTime.getFullYear()+"/"+$.Oda.Tooling.pad2(currentTime.getMonth()+1)+"/"+$.Oda.Tooling.pad2(currentTime.getDate())+" "+hours+":"+minutes+":"+$.Oda.Tooling.pad2(currentTime.getSeconds())}catch(er){return $.Oda.Log.error("$.Oda.Date.getStrDateTime: "+er.message),null}},dateFormat:function(myDate,format){try{myDate instanceof Date||(myDate=new Date(myDate));var yearFull=myDate.getFullYear(),year=myDate.getYear(),mounth=$.Oda.Tooling.pad2(myDate.getMonth()+1),day=$.Oda.Tooling.pad2(myDate.getDate()),hour=$.Oda.Tooling.pad2(myDate.getHours()),minute=$.Oda.Tooling.pad2(myDate.getMinutes()),second=$.Oda.Tooling.pad2(myDate.getSeconds());return format.replace(new RegExp("yyyy","ig"),yearFull).replace(new RegExp("yy","ig"),year).replace(new RegExp("mm","ig"),mounth).replace(new RegExp("dd","ig"),day).replace(new RegExp("hh","ig"),hour).replace(new RegExp("mi","ig"),minute).replace(new RegExp("ss","ig"),second)}catch(er){return $.Oda.Log.error("$.Oda.Date.dateFormat: "+er.message),null}}},Interface:{call:function(params){var response={strErreur:"No call",data:{},statut:4};if(params.odaInterface.length>0){var theInterface=params.odaInterface[0];params.odaInterface.splice(0,1),$.Oda.Log.debug("Call "+theInterface+" begin for: "+params.url),response=$.Oda.Interface.Methode[theInterface](params)}return response},callRest:function(p_url,p_tabSetting,p_tabInput){try{p_tabSetting.hasOwnProperty("functionRetour")&&!p_tabSetting.hasOwnProperty("callback")&&(p_tabSetting.callback=p_tabSetting.functionRetour,delete p_tabSetting.functionRetour);var interfaces=$.Oda.Tooling.clone($.Oda.Context.modeInterface);if($.Oda.Context.dev)for(var index in interfaces)"cache"===interfaces[index]&&interfaces.splice(index,1);var jsonAjaxParam={url:p_url,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"json",type:"GET",async:p_tabSetting.hasOwnProperty("callback"),odaInterface:interfaces,context:{}};p_tabSetting.hasOwnProperty("odaCacheOnDemande")||(p_tabSetting.odaCacheOnDemande=!1),null!==p_tabInput&&void 0!==p_tabInput||(p_tabInput={keyAuthODA:null});var session=$.Oda.Storage.get("ODA-SESSION"),key=null;null!==session?key=session.key:(key=p_tabInput.keyAuthODA,delete p_tabInput.keyAuthODA),p_tabInput.milis=$.Oda.Tooling.getMilise(),p_tabInput.ctrl="OK",p_tabInput.keyAuthODA=key,jsonAjaxParam.data=p_tabInput;for(var indice in p_tabSetting)jsonAjaxParam[indice]=p_tabSetting[indice];return jsonAjaxParam.context.odaKey=p_url,jsonAjaxParam.context.odaAttrs=p_tabInput,$.Oda.Interface.call(jsonAjaxParam)}catch(er){var msg="$.Oda.Interface.callRest : "+er.message;return $.Oda.Context.console.error(msg),null}},Methode:{ajax:function(params){var retour;$.ajax(params).done(function(data,textStatus,jqXHR){if(void 0===data?data={strErreur:"",data:{},statut:4}:"object"==typeof data?!data.hasOwnProperty("strErreur")||"key auth expiree."!=data.strErreur&&"key auth invalid."!=data.strErreur||$.Oda.Security.logout():data={strErreur:data,data:{},statut:4},data.hasOwnProperty("strErreur")&&"not found"===data.strErreur)params.odaInterface.length>0?retour=$.Oda.Interface.call(params):$.Oda.Event.send({name:"oda-notification-flash",data:{type:"error",msg:"$.Oda.Interface.Methode.ajax: "+data.strErreur}});else if(data.hasOwnProperty("strErreur")&&""!==data.strErreur&&4===data.statut)$.Oda.Event.send({name:"oda-notification-flash",data:{type:"error",msg:"$.Oda.Interface.Methode.ajax: "+data.strErreur}});else if($.Oda.Tooling.isInArray("cache",$.Oda.Context.modeInterface)){var attrs=$.Oda.Tooling.clone(this.odaAttrs);attrs.hasOwnProperty("ctrl")&&delete attrs.ctrl,attrs.hasOwnProperty("milis")&&delete attrs.milis,attrs.hasOwnProperty("keyAuthODA")&&delete attrs.keyAuthODA,$.Oda.Cache.save({key:this.odaKey,attrs:attrs,datas:data}),$.Oda.Log.debug("Call ajax success for: "+params.url),data.context=this,$.Oda.Tooling.isUndefined(params.callback)?retour=data:params.callback(data)}else $.Oda.Log.debug("Call ajax success for: "+params.url),data.context=this,$.Oda.Tooling.isUndefined(params.callback)?retour=data:params.callback(data)}).fail(function(jqXHR,textStatus,errorThrown){var msg=textStatus+" - "+errorThrown+" on "+params.url;$.Oda.Log.error("$.Oda.Interface.Methode.ajax: "+msg);var data={strErreur:msg,data:{},statut:404};params.odaInterface.length>0&&"error"===textStatus?retour=$.Oda.Interface.call(params):($.Oda.Event.send({name:"oda-notification-flash",data:{type:"error",msg:"$.Oda.Interface.Methode.ajax: "+msg}}),data.context=this,$.Oda.Tooling.isUndefined(params.callback)?retour=data:params.callback(data))});return retour},mokup:function(params){var retour=$.Oda.MokUp.get({url:params.url,tabInput:params.data})
;return retour.hasOwnProperty("strErreur")&&retour.strErreur.startsWith("No mokup found for")&&params.odaInterface.length>0?$.Oda.Interface.call(params):(retour.context=params.context,$.Oda.Log.debug("Call mokup success for : "+params.url),$.Oda.Tooling.isUndefined(params.callback)?retour:void params.callback(retour))},cache:function(params){var attrs=$.Oda.Tooling.clone(params.data);attrs.hasOwnProperty("ctrl")&&delete attrs.ctrl,attrs.hasOwnProperty("milis")&&delete attrs.milis,attrs.hasOwnProperty("keyAuthODA")&&delete attrs.keyAuthODA;var retour=$.Oda.Cache.load({key:params.url,attrs:attrs,demande:params.odaCacheOnDemande});if(retour){var datas=retour.datas;return datas.context=params.context,$.Oda.Log.debug("Call cache success for: "+params.url),$.Oda.Tooling.isUndefined(params.callback)?datas:void params.callback(datas)}if(params.odaInterface.length>0)return $.Oda.Interface.call(params);var msg="No found in cache: "+params.url+", and cache is the last interface.";$.Oda.Event.send({name:"oda-notification-flash",data:{type:"error",msg:msg}});var data={strErreur:msg,data:{},statut:404};return $.Oda.Log.error(msg),data.context=params.context,$.Oda.Tooling.isUndefined(params.callback)?data:void params.callback(data)},offline:function(params){try{var attrs=$.Oda.Tooling.clone(params.data);attrs.hasOwnProperty("ctrl")&&delete attrs.ctrl,attrs.hasOwnProperty("milis")&&delete attrs.milis,attrs.hasOwnProperty("keyAuthODA")&&delete attrs.keyAuthODA;var retour=$.Oda.Cache.loadWithOutTtl({key:params.url,attrs:attrs});if(retour){var datas=retour.datas;return datas.context=params.context,$.Oda.Log.debug("Call offline success for : "+params.url),$.Oda.Tooling.isUndefined(params.callback)?datas:void params.callback(datas)}if(params.odaInterface.length>0)return $.Oda.Interface.call(params);var msg="No found in offline : "+params.url+", and offline is the last interface.";$.Oda.Event.send({name:"oda-notification-flash",data:{type:"error",msg:msg}});var data={strErreur:msg,data:{},statut:404};return data.context=params.context,$.Oda.Tooling.isUndefined(params.callback)?data:void params.callback(data)}catch(er){return $.Oda.Context.console.error("$.Oda.Interface.offline : "+er.message),null}}},getParameter:function(p_param_name){try{var strResponse,json_retour=$.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/sys/param/"+p_param_name,{});if(""===json_retour.strErreur){var type=json_retour.data.param_type,value=json_retour.data.param_value;switch(type){case"int":strResponse=parseInt(value);break;case"float":strResponse=$.Oda.Tooling.arrondir(parseFloat(value),2);break;case"varchar":default:strResponse=value}}return strResponse}catch(er){return $.Oda.Log.error("$.Oda.Interface.getParameter : "+er.message),null}},getRangs:function(){try{var valeur=$.Oda.Storage.get("ODA_rangs");if(null===valeur){var retour=$.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/rank/",{});""===retour.strErreur?valeur=retour.data:$.Oda.Display.Notification.error(retour.strErreur),$.Oda.Storage.set("ODA_rangs",valeur,$.Oda.Storage.ttl_default)}return valeur}catch(er){return $.Oda.Log.error("$.Oda.Interface.getRangs: "+er.message),null}},addStat:function(p_user,p_page,p_action){try{return $.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/sys/page/trace",{type:"post",callback:function(){$.Oda.Log.debug("$.Oda.Interface.addStat:'"+p_user+"', '"+p_page+"', '"+p_action+"'")}},{user:p_user,page:p_page,action:p_action}),this}catch(er){return $.Oda.Log.error("$.Oda.Interface.addStat: "+er.message),null}},sendMail:function(p_params){try{var params_attempt={email_mails_dest:null,message_html:null,sujet:null},params=$.Oda.Tooling.checkParams(p_params,params_attempt);if(null===params)return!1;return $.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/script/send_mail.php",{type:"POST"},params)}catch(er){return $.Oda.Log.error("$.Oda.Interface.sendMail :"+er.message),null}},traceLog:function(p_params){try{return $.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/sys/log/",{type:"post",callback:function(response){$.Oda.Log.debug("Log success id:"+response.data)}},{type:1,msg:p_params.msg}),this}catch(er){return $.Oda.Context.console.error("$.Oda.Interface.traceLog) :"+er.message),null}}},Display:{Polyfill:{createHtmlElement:function(params){try{$.Oda.Log.debug("CreateHtmlElement: "+params.name);var elt=Object.create(HTMLElement.prototype);return elt.createdCallback=params.createdCallback,void 0!==params.attributeChangedCallback&&(elt.attributeChangedCallback=params.attributeChangedCallback),void 0!==params.attachedCallback&&(elt.attachedCallback=params.attachedCallback),void 0!==params.detachedCallback&&(elt.detachedCallback=params.detachedCallback),document.registerElement(params.name,{prototype:elt}),this}catch(er){return $.Oda.Log.error("$.Oda.polyfill.createHtmlElement : "+er.message),null}},extendHtmlElement:function(params){try{$.Oda.Log.debug("extendHtmlElement: "+params.name);var elt=Object.create(HTMLElement.prototype);return elt.createdCallback=params.createdCallback,void 0!==params.attributeChangedCallback&&(elt.attributeChangedCallback=params.attributeChangedCallback),void 0!==params.attachedCallback&&(elt.attachedCallback=params.attachedCallback),void 0!==params.detachedCallback&&(elt.detachedCallback=params.detachedCallback),document.registerElement(params.name,{prototype:elt,extends:params.type}),this}catch(er){return $.Oda.Log.error("$.Oda.polyfill.extendHtmlElement : "+er.message),null}}},Notification:{id:0,success:function(p_message){this.create(p_message,"success",2e3)},successI8n:function(p_message){this.create($.Oda.I8n.getByString(p_message),"success",2e3)},info:function(p_message){this.create(p_message,"info",3e3)},infoI8n:function(p_message){this.create($.Oda.I8n.getByString(p_message),"info",3e3)},warning:function(p_message){this.create(p_message,"warning",5e3)},warningI8n:function(p_message){this.create($.Oda.I8n.getByString(p_message),"warning",5e3)},danger:function(p_message){this.create(p_message,"danger")},dangerI8n:function(p_message){this.create($.Oda.I8n.getByString(p_message),"danger")},error:function(p_message){this.create(p_message,"danger"),$.Oda.Log.error(p_message)},errorI8n:function(p_message){var message=$.Oda.I8n.getByString(p_message);this.create(message,"danger"),$.Oda.Log.error(message)},load:function(){try{var html=$.Oda.Display.TemplateHtml.create({template:"oda-notification-tpl"});return $("body").append(html),$.Oda.Event.addListener({name:"oda-notification-flash",callback:function(e){return $.Oda.Display.Notification[e.detail.type](e.detail.msg),this}}),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Notification.load : "+er.message),null}},create:function(p_message,p_type,time){try{$.Oda.Display.Notification.id++;var strHtml=$.Oda.Display.TemplateHtml.create({template:"oda-notification-message-tpl",scope:{type:p_type,id:$.Oda.Display.Notification.id,message:p_message}});return $("#oda-notification").append(strHtml),$.Oda.Tooling.isUndefined(time)||$.Oda.Tooling.timeout($.Oda.Display.Notification.remove,time,{id:$.Oda.Display.Notification.id}),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Notification.create :"+er.message),null}},remove:function(params){try{return $("#oda-notification-"+params.id).fadeOut(500,function(){$(this).remove()}),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Notification.remove :"+er.message),null}},removeAll:function(){try{$("[id^='oda-notification-']").filter(function(index){return $(this).hasClass("alert")}).fadeOut(500,function(){$(this).remove()});return this}catch(er){return $.Oda.Log.error("$.Oda.Display.Notification.removeAll :"+er.message),null}}},Scene:{load:function(){try{var htmlScene=$.Oda.Display.TemplateHtml.create({template:"oda-scene-tpl"});return $("body").append(htmlScene),$("[oda-avatar-name=avatar]").click(function(e){e.preventDefault(),$("#wrapper").toggleClass("toggled")}),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Scene.load : "+er.message),null}}},MenuSlide:{display:!1,show:function(){try{if(!this.display){var strHtml=$.Oda.Display.TemplateHtml.create({template:"oda-scene-menuSlide-logged-tpl",scope:{firstName:$.Oda.Session.userInfo.firstName.substr(0,9),lastName:$.Oda.Session.userInfo.lastName.substr(0,9)}});$("#menuSlide").html(strHtml),this.display=!0}}catch(er){$.Oda.Log.error("$.Oda.Display.MenuSlide.show : "+er.message)}},remove:function(){try{$("#wrapper").removeClass("toggled");var strHtml=$.Oda.Display.TemplateHtml.create({template:"oda-scene-menuSlide-default-tpl"});$("#menuSlide").html(strHtml),this.display=!1}catch(er){$.Oda.Log.error("$.Oda.Display.MenuSlide.remove: "+er.message)}}},Menu:{display:!1,show:function(){try{this.display||$.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/navigation/right/",{callback:function(response){var strHTML="",datas=response.data,cate="";for(var indice in datas)if("98"!==datas[indice].id_categorie&&"1"!==datas[indice].id_categorie){datas[indice].id_categorie!==cate&&(cate=datas[indice].id_categorie,"0"!==indice&&(strHTML+="</ul></li>"),strHTML+='<li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><oda-label oda-label-value="'+datas[indice].Description_cate+'"/><span class="caret"></span></a><ul class="dropdown-menu" role="menu">');var route=datas[indice].Lien;route=route.replace("api_page_",""),route=route.replace("page_",""),route=route.replace(".html",""),strHTML+="<li><a onclick=\"$.Oda.Router.navigateTo({'route':'"+route+"','args':{}});\"><oda-label oda-label-value='"+datas[indice].Description_courte+"'/></a></li>"}$("#menu").html(strHTML),$.Oda.Display.display=!0}})}catch(er){$.Oda.Log.error("$.Oda.Display.Menu.show : "+er.message)}},remove:function(){try{$("#menu").html(""),this.display=!1}catch(er){$.Oda.Log.error("$.Oda.Display.Menu.remove : "+er.message)}}},Message:{show:function(){try{return $.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/message/current",{callback:function(response){for(var indice in response.data){var message=response.data[indice];if(!$("#oda-message-"+message.id).length){var strHtml=$.Oda.Display.TemplateHtml.create({template:"oda-message-tpl",scope:{alertType:message.niveau,id:message.id,message:message.message}});$("#"+$.Oda.Context.mainDiv).before(strHtml)}}}},{code_user:$.Oda.Session.code_user}),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Message.show: "+er.message),null}},hide:function(p_params){try{return $.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/message/read/"+p_params.id,{callback:function(datas){$("#oda-message-"+p_params.id).remove()}}),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Message.hide  : "+er.message),null}}},Popup:{iterator:0,open:function(p_params){try{p_params.hasOwnProperty("name")||($.Oda.Display.Popup.iterator++,p_params.name="oda-popup"+$.Oda.Display.Popup.iterator);var htmlPopUp=$.Oda.Display.TemplateHtml.create({template:"oda-popup-tpl",scope:{name:p_params.name}});$("body").append(htmlPopUp),p_params.hasOwnProperty("size")&&$("#"+p_params.name+" .modal-dialog").addClass("modal-"+p_params.size),$("#"+p_params.name+"_label").html("<b>"+p_params.label+"</b>");var contentPopup=p_params.details;$("#"+p_params.name+"_content").html(contentPopup),p_params.hasOwnProperty("footer")?$("#"+p_params.name+"_footer").html(p_params.footer):$("#"+p_params.name+"_footer").html('<button type="button" class="btn btn-default" data-dismiss="modal"><oda-label oda-label-value="oda-main.bt-close"/></button>'),p_params.hasOwnProperty("callback")?$("#"+p_params.name).on("shown.bs.modal",function(e){p_params.hasOwnProperty("callbackParams")?p_params.callback(p_params.callbackParams):p_params.callback()}):$("#"+p_params.name).unbind("shown.bs.modal"),$("#"+p_params.name).on("hidden.bs.modal",function(e){$("#"+p_params.name).remove()}),$("#"+p_params.name).modal("show")}catch(er){$.Oda.Log.error("$.Oda.Display.Popup.open : "+er.message)}},close:function(p_params){try{if($.Oda.Tooling.isUndefined(p_params))var p_params={};return p_params.hasOwnProperty("name")||(p_params.name="oda-popup"+$.Oda.Display.Popup.iterator),$("#"+p_params.name).modal("hide"),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Popup.close : "+er.message),null}},closeAll:function(){try{return $(".modal").each(function(index,value){$(value).modal("hide")}),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Popup.closeAll : "+er.message),null}}},TemplateHtml:{iterateLoadTemplate:0,create:function(p_params){try{$.Oda.Log.debug("$.Oda.Display.TemplateHtml.create: "+p_params.template);var $template=$("#"+p_params.template);if(!p_params.hasOwnProperty("callback")){if(void 0===$template.html())throw new Error("Template not load.");var strHtml=$template.html();if(p_params.hasOwnProperty("scope")){var listExpression=$.Oda.Tooling.findBetweenWords({str:$template.html(),first:"{{",last:"}}"});for(var indice in listExpression){var resultEval=$.Oda.Display.TemplateHtml.eval({exrp:listExpression[indice],scope:p_params.scope});strHtml=$.Oda.Tooling.replaceAll({str:strHtml,find:"{{"+listExpression[indice]+"}}",by:resultEval})}}return strHtml}if(void 0===$template.html())$.Oda.Display.TemplateHtml.iterateLoadTemplate<10&&($.Oda.Display.TemplateHtml.iterateLoadTemplate++,$.Oda.Log.error("$.Oda.Display.TemplateHtml.create: template load problem, retry."),setTimeout(function(){$.Oda.Display.TemplateHtml.create(p_params)},200));else{var strHtml=$template.html();if(p_params.hasOwnProperty("scope")){var listExpression=$.Oda.Tooling.findBetweenWords({str:$template.html(),first:"{{",last:"}}"});for(var indice in listExpression){var resultEval=$.Oda.Display.TemplateHtml.eval({exrp:listExpression[indice],scope:p_params.scope});strHtml=$.Oda.Tooling.replaceAll({str:strHtml,find:"{{"+listExpression[indice]+"}}",by:resultEval})}}p_params.callback(strHtml)}}catch(er){return $.Oda.Log.error("$.Oda.Display.TemplateHtml.create: "+er.message),null}},eval:function(p_params){try{var source="(function("+Object.keys(p_params.scope).join(", ")+") { return "+p_params.exrp+";})",compiled=eval(source),result=[];for(var property in p_params.scope)p_params.scope.hasOwnProperty(property)&&result.push(p_params.scope[property]);var evaluate=compiled.apply(p_params.scope,result);return evaluate}catch(er){return $.Oda.Log.error("$.Oda.Display.TemplateHtml.eval : "+er.message),null}}},Table:{createDataTable:function(p_params){try{var params_attempt={target:null,data:null,attribute:null};if(null===$.Oda.Tooling.checkParams(p_params,params_attempt))return!1;if(!Array.isArray(p_params.data))return $.Oda.Log.error("$.Oda.Display.Table.createDataTable: paramater 'data' is not an array"),!1;if(p_params.data.length>0&&"Object"!==$.Oda.Tooling.getTypeOfVar(p_params.data[0]))return $.Oda.Log.error("$.Oda.Display.Table.createDataTable: content paramater 'data' is not an object"),!1;var divTable=$("#"+p_params.target),strhtml='<table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered hover" id="table-'+p_params.target+'" style="width: 100%">',footer="";for(var indice in p_params.attribute){if(p_params.attribute[indice].hasOwnProperty("withFilter")){footer+="<tfoot><tr>";for(var indiceElt in p_params.attribute){var eltB=p_params.attribute[indiceElt];eltB.hasOwnProperty("withFilter")&&eltB.withFilter?footer+="<th></th>":footer+="<th>null</th>"}footer+="</tr></tfoot>";break}}strhtml+=footer+"</table>",divTable.html(strhtml);var eltTable=$("#table-"+p_params.target),objDataTable=$.Oda.Tooling.objDataTableFromJsonArray(p_params.data),dataTableParamsDefault={iDisplayLength:20,language:$.Oda.I8n.getByGroupName("oda-datatables"),aaData:objDataTable.data},dataTableParams=$.Oda.Tooling.merge({default:dataTableParamsDefault,source:p_params.option});dataTableParams.aaData=objDataTable.data;var columns=[],columnDefs=[],i=0;for(var key in p_params.attribute){var colomn={sTitle:p_params.attribute[key].header};p_params.attribute[key].hasOwnProperty("align")&&("right"===p_params.attribute[key].align?colomn.sClass="dataTableColRight":"left"===p_params.attribute[key].align?colomn.sClass="dataTableColLeft":"center"===p_params.attribute[key].align?colomn.sClass="dataTableColCenter":colomn.sClass=p_params.attribute[key].align),p_params.attribute[key].hasOwnProperty("size")&&(colomn.width=p_params.attribute[key].size),columns.push(colomn);var temp=p_params.attribute[key].value.toString(),reg=new RegExp("row.[a-zA-Z_-]+","gi"),tab=temp.match(reg);for(var indice in tab){var tabElt=tab[indice].split(".");temp=$.Oda.Tooling.replaceAll({str:temp,find:tab[indice],by:"full["+objDataTable.entete[tabElt[1]]+"]"})}var newImple=new Function("data","type","full","meta",temp.substring(temp.indexOf("{")+1,temp.lastIndexOf("}"))),value={mRender:newImple,aTargets:[i]};columnDefs.push(value),i++}dataTableParams.aoColumns=columns,dataTableParams.aoColumnDefs=columnDefs;var oTable=eltTable.DataTable(dataTableParams);return $("#table-"+p_params.target+" tbody").on("click","tr",function(){$(this).hasClass("selected")?$(this).removeClass("selected"):(oTable.$("tr.selected").removeClass("selected"),$(this).addClass("selected"))}),$("#table-"+p_params.target+" tfoot th").each(function(i){if("select"==$(this).attr("oda-attr")){var select=$('<select data-mini="true"><option></option></select>').appendTo($(this).empty()).on("change",function(){var val=$(this).val();oTable.column(i).search(val?"^"+$(this).val()+"$":val,!0,!1).draw()});oTable.column(i-1).data().unique().sort().each(function(d,j){select.append('<option value="'+d+'">'+d+"</option>")})}else"null"!==$(this).html()?$('<input type="text" placeholder="Search" size="4"/>').appendTo($(this).empty()).on("keyup change",function(){oTable.column(i).search(this.value).draw()}):$(this).html("")}),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Table.createDataTable: "+er.message),null}}},Push:{create:function(params){try{return"Notification"in $.Oda.Context.window?"granted"===$.Oda.Context.window.Notification.permission?void 0!==params.options&&null!==params.options?new $.Oda.Context.window.Notification(params.message,params.options):new $.Oda.Context.window.Notification(params.message):"denied"!==$.Oda.Context.window.Notification.permission?($.Oda.Context.window.Notification.requestPermission(function(permission){if("permission"in $.Oda.Context.window.Notification||($.Oda.Context.window.Notification.permission=permission),"granted"===permission)if(void 0!==params.options&&null!==params.options){new $.Oda.Context.window.Notification(params.message,params.options)}else{new $.Oda.Context.window.Notification(params.message)}}),!0):null:($.Oda.Log.warning("Ce navigateur ne supporte pas les notifications desktop"),null)}catch(er){return $.Oda.Log.error("$.Oda.Display.Push.create : "+er.message),null}},createI8n:function(params){try{return params.message=$.Oda.I8n.getByString(params.message),this.create(params)}catch(er){return $.Oda.Log.error("$.Oda.Display.Push.createI8n : "+er.message),null}}},Widget:{load:function(){try{$.Oda.Display.Widget.loadBtn(),$.Oda.Display.Widget.loadTextInput(),$.Oda.Display.Widget.loadAreaInput(),$.Oda.Display.Widget.loadCheckboxInput(),$.Oda.Display.Widget.loadSelectInput(),$.Oda.Display.Widget.loadLoading(),$.Oda.Display.Widget.loadLabel(),$.Oda.Display.Widget.loadAvatar(),$.Oda.Display.Widget.loadGuidance()}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.load: "+er.message),null}},checkBtnEnter:function(){try{$(document).unbind("keypress");var maxPrio,maxBt;$("[oda-btn-enter]").each(function(index){var current=$(this);current.removeClass("btn-listenEnter");var currentPrio=parseInt(current.attr("oda-btn-enter"));void 0===maxPrio||currentPrio>maxPrio?(maxPrio=currentPrio,maxBt=current):current.removeClass("btn-listenEnter")}),maxBt&&(maxBt.addClass("btn-listenEnter"),$(document).keypress(function(e){if(13===e.which){if(!maxBt.attr("oda-btn-click"))throw new Error("Not clickable");maxBt.click()}}))}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.checkBtnEnter: "+er.message),null}},loadBtn:function(){try{$.Oda.Display.Polyfill.createHtmlElement({name:"oda-btn",createdCallback:function(){var elt=$(this),name=elt.attr("oda-btn-name");if(name){if($.Oda.Context.window.document.getElementById(name))throw new Error("Id:'"+name+"' already exist");if($.Oda.Context.window.document.getElementsByName(name).length>0)throw new Error("Name:'"+name+"' already exist");elt.attr("id",name),elt.attr("name",name)}elt.attr("type","button");var text=elt.text();""!==text&&elt.html('<oda-label oda-label-value="'+text+'"/>');var style=elt.attr("oda-btn-style"),alreadyClass=elt.attr("class");alreadyClass?elt.attr("class","btn btn-"+style+" "+alreadyClass):elt.attr("class","btn btn-"+style);var iconAfter=elt.attr("oda-btn-icon-after"),iconBefore=elt.attr("oda-btn-icon-before");iconBefore&&elt.prepend('<span class="glyphicon glyphicon-'+iconBefore+'" aria-hidden="true"></span> '),iconAfter&&elt.append(' <span class="glyphicon glyphicon-'+iconAfter+'" aria-hidden="true"></span>'),elt.attr("oda-btn-enter")&&$.Oda.Display.Widget.checkBtnEnter();var odaBtnTips=elt.attr("oda-btn-tips");if(odaBtnTips){var tipsTrad=$.Oda.I8n.getByString(odaBtnTips);elt.attr("title",tipsTrad)}elt.click(function(event){event.preventDefault();var disabled=elt.attr("disabled"),click=elt.attr("oda-btn-click");if(click&&!disabled)try{new Function(click)()}catch(e){throw new Error("Not a function")}})},attributeChangedCallback:function(attrName,oldValue,newValue){$(this)},attachedCallback:function(){$(this).attr("oda-btn-enter")&&$.Oda.Display.Widget.checkBtnEnter()},detachedCallback:function(){$.Oda.Display.Widget.checkBtnEnter()}})}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.loadBtn: "+er.message),null}},checkInputText:function(p){try{var $elt=$(p.elt);if(!p.required||void 0!==$elt.val()&&""!==$elt.val()){if(p.check){p.check.startsWith("Oda.Regexs:")&&(p.check=p.check.replace("Oda.Regexs:",""),p.check=$.Oda.Regexs[p.check]);var patt=new RegExp(p.check,"g"),res=patt.test($elt.val());res?($elt.data("isOk",!0),$elt.css("border-color","#04B404")):($elt.data("isOk",!1),$elt.css("border-color","#FF0000"))}}else $elt.data("isOk",!1),$elt.css("border-color","#FF0000");return this}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.checkInputText: "+er.message),null}},checkTextValue:function(p){try{var $elt=$(p.elt);if(!p.required||void 0!==p.text&&""!==p.text){if(p.check){p.check.startsWith("Oda.Regexs:")&&(p.check=p.check.replace("Oda.Regexs:",""),p.check=$.Oda.Regexs[p.check]);var patt=new RegExp(p.check,"g"),res=patt.test(p.text);res?($elt.data("isOk",!0),$elt.css("border-color","#04B404")):($elt.data("isOk",!1),$elt.css("border-color","#FF0000"))}}else $elt.data("isOk",!1),$elt.css("border-color","#FF0000");return this}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.checkTextValue: "+er.message),null}},loadTextInput:function(){try{$.Oda.Display.Polyfill.createHtmlElement({name:"oda-input-text",createdCallback:function(){var elt=$(this),name=elt.attr("oda-input-text-name");if($.Oda.Context.window.document.getElementById(name))throw new Error("Id:'"+name+"' already exist");if($.Oda.Context.window.document.getElementsByName(name).length>0)throw new Error("Name:'"+name+"' already exist");var type=elt.attr("oda-input-text-type");type||(type="text");var value=elt.attr("oda-input-text-value");value||(value="");var label=elt.attr("oda-input-text-label"),labelTrad="",labelDisplayHtml="";label?labelTrad='<oda-label oda-label-value="'+label+'"/>':labelDisplayHtml="display:none;";var tips=elt.attr("oda-input-text-tips"),tipsHtml="",tipsDisplayHtml="";tips?tipsHtml=$.Oda.I8n.getByString(tips):tipsDisplayHtml="display:none;";var advice=elt.attr("oda-input-text-advice"),adviceHtml="",adviceDisplayInputHtml="input-group",adviceDisplayHtml="";advice?adviceHtml=$.Oda.I8n.getByString(advice):(adviceDisplayInputHtml="",adviceDisplayHtml="display:none;");var required=elt.attr("required"),requiredStart="",requiredBalise="";required&&(requiredStart='<span style="color:red;">*</span>',requiredBalise="required");var disabled=elt.attr("disabled"),disabledBalise="";disabled&&(disabledBalise="disabled");var html=$.Oda.Display.TemplateHtml.create({template:"oda-widget-input-text-tpl",scope:{id:name,name:name,label:labelTrad,requiredStart:requiredStart,requiredBalise:requiredBalise,disabledBalise:disabledBalise,type:type,tips:tipsHtml,advice:adviceHtml,labelDisplay:labelDisplayHtml,tipsDisplay:tipsDisplayHtml,adviceDisplayInput:adviceDisplayInputHtml,adviceDisplay:adviceDisplayHtml,value:value}});$(this).html(html)},attributeChangedCallback:function(attrName,oldValue,newValue){var elt=$(this),name=elt.attr("oda-input-text-name"),$inputText=$("#"+name);switch(attrName){case"oda-input-text-value":$inputText.val(newValue);break;case"disabled":null===oldValue?$inputText.attr("disabled",""):$inputText.removeAttr("disabled")}},attachedCallback:function(){var elt=$(this),name=elt.attr("oda-input-text-name"),tips=elt.attr("oda-input-text-tips"),advice=elt.attr("oda-input-text-advice"),placeholder=elt.attr("oda-input-text-placeholder"),check=elt.attr("oda-input-text-check"),required=elt.attr("required"),paste=elt.attr("oda-input-text-paste"),debounce=elt.attr("oda-input-text-debounce"),throttle=elt.attr("oda-input-text-throttle"),$inputText=$("#"+name);if(tips){var tipsText=$.Oda.I8n.getByString(tips),$spanTips=$inputText.parent().parent().find("span:last");$inputText.focus(function(){$spanTips.html(tipsText)}),$inputText.focusout(function(){$spanTips.html("&nbsp;")})}if(advice){$inputText.parent().parent().find("button:last").click(function(){$(this).popover("show")})}placeholder&&$inputText.attr("placeholder",$.Oda.I8n.getByString(placeholder)),paste&&"false"===paste&&$inputText.bind("paste",function(e){e.preventDefault()}),$.Oda.Display.Widget.checkInputText({elt:$inputText.get(0),required:required,check:check}),$inputText.bind("keyup mouseup change",function(e){$.Oda.Display.Widget.checkInputText({elt:e.target,required:required,check:check}),debounce?$.Oda.Tooling.debounce(function(){$.Oda.Scope.Gardian.findByElt({id:e.target.id})},parseInt(debounce)):throttle?$.Oda.Tooling.throttle(function(){$.Oda.Scope.Gardian.findByElt({id:e.target.id})},parseInt(throttle)):$.Oda.Scope.Gardian.findByElt({id:e.target.id})})},detachedCallback:function(){}})}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.loadTextInput: "+er.message),null}},loadAreaInput:function(){try{$.Oda.Display.Polyfill.createHtmlElement({name:"oda-input-area",createdCallback:function(){var elt=$(this),name=elt.attr("oda-input-area-name");if($.Oda.Context.window.document.getElementById(name))throw new Error("Id:'"+name+"' already exist");if($.Oda.Context.window.document.getElementsByName(name).length>0)throw new Error("Name:'"+name+"' already exist");var hight=elt.attr("oda-input-area-hight");hight||(hight="3");var value=elt.attr("oda-input-area-value");value||(value="");var label=elt.attr("oda-input-area-label"),labelTrad="",labelDisplayHtml="";label?labelTrad='<oda-label oda-label-value="'+label+'"/>':labelDisplayHtml="display:none;";var tips=elt.attr("oda-input-area-tips"),tipsHtml="",tipsDisplayHtml="";tips?tipsHtml=$.Oda.I8n.getByString(tips):tipsDisplayHtml="display:none;";var required=elt.attr("required"),requiredStart="",requiredBalise="";required&&(requiredStart='<span style="color:red;">*</span>',requiredBalise="required");var disabled=elt.attr("disabled"),disabledBalise="";disabled&&(disabledBalise="disabled");var html=$.Oda.Display.TemplateHtml.create({template:"oda-widget-input-area-tpl",scope:{id:name,name:name,label:labelTrad,requiredStart:requiredStart,requiredBalise:requiredBalise,hight:hight,labelDisplay:labelDisplayHtml,tips:tipsHtml,tipsDisplay:tipsDisplayHtml,disabledBalise:disabledBalise,value:value}});$(this).html(html)},attributeChangedCallback:function(attrName,oldValue,newValue){var elt=$(this),name=elt.attr("oda-input-area-name"),rich=elt.attr("oda-input-area-rich"),$inputArea=$("#"+name);switch(attrName){case"oda-input-area-value":$inputArea.val(newValue);break;case"disabled":rich?null===oldValue?CKEDITOR.instances[name].setReadOnly(!0):CKEDITOR.instances[name].setReadOnly(!1):null===oldValue?$inputArea.attr("disabled",""):$inputArea.removeAttr("disabled")}},attachedCallback:function(){var elt=$(this),name=elt.attr("oda-input-area-name"),tips=elt.attr("oda-input-area-tips"),placeholder=elt.attr("oda-input-area-placeholder"),check=elt.attr("oda-input-area-check"),required=elt.attr("required"),paste=elt.attr("oda-input-area-paste"),debounce=elt.attr("oda-input-area-debounce"),throttle=elt.attr("oda-input-area-throttle"),rich=elt.attr("oda-input-area-rich");if(rich)try{CKEDITOR.replace(name)}catch(e){$.Oda.Log.error('Rich area demand for widget:"'+name+'" but CKEDITOR not loaded'),rich=!1}var $inputArea=$("#"+name);if(tips){var tipsText=$.Oda.I8n.getByString(tips),$spanTips=$inputArea.parent().parent().find("span:last");rich?(CKEDITOR.instances[name].on("focus",function(){$spanTips.html(tipsText)}),CKEDITOR.instances[name].on("blur",function(){$spanTips.html("&nbsp;")})):($inputArea.focus(function(){$spanTips.html(tipsText)}),$inputArea.focusout(function(){$spanTips.html("&nbsp;")}))}placeholder&&$inputArea.attr("placeholder",$.Oda.I8n.getByString(placeholder)),paste&&"false"===paste&&$inputArea.bind("paste",function(e){e.preventDefault()}),rich?($.Oda.Display.Widget.checkTextValue({elt:$inputArea.get(0),text:CKEDITOR.instances[name].getData(),required:required,check:check}),CKEDITOR.instances[name].on("change",function(){$.Oda.Display.Widget.checkTextValue({elt:$inputArea.get(0),text:CKEDITOR.instances[name].getData(),required:required,check:check}),debounce?$.Oda.Tooling.debounce(function(){$.Oda.Scope.Gardian.findByElt({id:name})},parseInt(debounce)):throttle?$.Oda.Tooling.throttle(function(){$.Oda.Scope.Gardian.findByElt({id:name})},parseInt(throttle)):$.Oda.Scope.Gardian.findByElt({id:name})})):($.Oda.Display.Widget.checkInputText({elt:$inputArea.get(0),required:required,check:check}),$inputArea.bind("keyup mouseup change",function(e){$.Oda.Display.Widget.checkInputText({elt:e.target,required:required,check:check}),debounce?$.Oda.Tooling.debounce(function(){$.Oda.Scope.Gardian.findByElt({id:e.target.id})},parseInt(debounce)):throttle?$.Oda.Tooling.throttle(function(){$.Oda.Scope.Gardian.findByElt({id:e.target.id})},parseInt(throttle)):$.Oda.Scope.Gardian.findByElt({id:e.target.id})}))},detachedCallback:function(){}})}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.loadAreaInput: "+er.message),null}},loadCheckboxInput:function(){try{$.Oda.Display.Polyfill.createHtmlElement({name:"oda-input-checkbox",createdCallback:function(){var elt=$(this),name=elt.attr("oda-input-checkbox-name");if($.Oda.Context.window.document.getElementById(name))throw new Error("Id:'"+name+"' already exist");if($.Oda.Context.window.document.getElementsByName(name).length>0)throw new Error("Name:'"+name+"' already exist");var value=elt.attr("oda-input-checkbox-value");value||(value="");var label=elt.attr("oda-input-checkbox-label"),labelTrad="",labelDisplayHtml="";label?labelTrad='<oda-label oda-label-value="'+label+'"/>':labelDisplayHtml="display:none;";var required=elt.attr("required"),requiredStart="",requiredBalise="";required&&(requiredStart='<span style="color:red;">*</span>',requiredBalise="required");var tips=elt.attr("oda-input-checkbox-tips"),tipsHtml="";tips&&(tipsHtml=$.Oda.I8n.getByString(tips));var disabled=elt.attr("disabled"),disabledBalise="";disabled&&(disabledBalise="disabled");var html=$.Oda.Display.TemplateHtml.create({template:"oda-widget-input-checkbox-tpl",scope:{id:name,name:name,label:labelTrad,labelDisplay:labelDisplayHtml,requiredStart:requiredStart,requiredBalise:requiredBalise,
disabledBalise:disabledBalise,tips:tipsHtml,value:value}});$(this).html(html)},attributeChangedCallback:function(attrName,oldValue,newValue){var elt=$(this),name=elt.attr("oda-input-checkbox-name"),$inputCheckbox=$("#"+name);switch(attrName){case"disabled":null===oldValue?$inputCheckbox.attr("disabled",""):$inputCheckbox.removeAttr("disabled")}},attachedCallback:function(){var elt=$(this),name=elt.attr("oda-input-checkbox-name"),required=elt.attr("required"),$inputCheckbox=$("#"+name);required?$inputCheckbox.data("isOk",$inputCheckbox.is(":checked")):$inputCheckbox.data("isOk",!0),$inputCheckbox.val($inputCheckbox.is(":checked")),$inputCheckbox.change(function(e){var $elt=$(this);$elt.val($elt.is(":checked")),required?$elt.data("isOk",$elt.is(":checked")):$elt.data("isOk",!0),$.Oda.Scope.Gardian.findByElt({id:e.target.id})})},detachedCallback:function(){}})}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.loadCheckboxInput: "+er.message),null}},refreshAvailablesOfSelect:function(p){try{var elt=$(p.elt),name=elt.attr("oda-input-select-name"),order=elt.attr("oda-input-select-order"),$select=$("#"+name);$select.find("option").remove();var value=elt.attr("oda-input-select-value");value||(value="");var availablesString=elt.attr("oda-input-select-availables"),funct=new Function("return "+availablesString),availables=funct();if(!Array.isArray(availables))throw new Error("availables is not an array for:'"+name+"'.");if(availables.length>0)if("object"==typeof availables[0]){var display=elt.attr("oda-input-select-display");if(!display)throw new Error("display is not define for:'"+name+"' event availables are object.");var functDisplay=new Function("elt","return "+display),response=elt.attr("oda-input-select-response");if(!response)throw new Error("response is not define for:'"+name+"' event availables are object.");var functResponse=new Function("elt","return "+response);for(var index in availables){var currentValue=availables[index],displayCalc=functDisplay(currentValue);currentValue.valueTrad=$.Oda.I8n.getByString(displayCalc)}"desc"===order?listWavailablesithTrad=$.Oda.Tooling.order({collection:availables,compare:function(elt1,elt2){return elt1.valueTrad<elt2.valueTrad?1:elt1.valueTrad>elt2.valueTrad?-1:0}}):"asc"===order&&(availables=$.Oda.Tooling.order({collection:availables,compare:function(elt1,elt2){return elt1.valueTrad>elt2.valueTrad?1:elt1.valueTrad<elt2.valueTrad?-1:0}})),$select.append($("<option>").text($.Oda.I8n.get("oda-main","select-default")).val(""));for(var index in availables){var currentValue=availables[index],responseCalc=functResponse(currentValue);$select.append($("<option>").text(currentValue.valueTrad).val(responseCalc))}$select.val(value)}else{var listWithTrad=[];for(var index in availables){var currentValue=availables[index];listWithTrad.push({value:currentValue,valueTrad:$.Oda.I8n.getByString(currentValue)})}"desc"===order?listWithTrad=$.Oda.Tooling.order({collection:listWithTrad,compare:function(elt1,elt2){return elt1.valueTrad<elt2.valueTrad?1:elt1.valueTrad>elt2.valueTrad?-1:0}}):"asc"===order&&(listWithTrad=$.Oda.Tooling.order({collection:listWithTrad,compare:function(elt1,elt2){return elt1.valueTrad>elt2.valueTrad?1:elt1.valueTrad<elt2.valueTrad?-1:0}})),$select.append($("<option>").text($.Oda.I8n.get("oda-main","select-default")).val(""));for(var index in listWithTrad){var currentValue=listWithTrad[index];$select.append($("<option>").text(currentValue.valueTrad).val(currentValue.value))}$select.val(value)}else $select.append($("<option>").text($.Oda.I8n.get("oda-main","select-default")).val("")),$select.val(value);$.Oda.Scope.Gardian.findByElt({id:name})}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.refreshAvailablesOfSelect: "+er.message),null}},loadSelectInput:function(){try{$.Oda.Display.Polyfill.createHtmlElement({name:"oda-input-select",createdCallback:function(){var elt=$(this),name=elt.attr("oda-input-select-name");if($.Oda.Context.window.document.getElementById(name))throw new Error("Id:'"+name+"' already exist");if($.Oda.Context.window.document.getElementsByName(name).length>0)throw new Error("Name:'"+name+"' already exist");var label=elt.attr("oda-input-select-label"),labelTrad="",labelDisplayHtml="";label?labelTrad='<oda-label oda-label-value="'+label+'"/>':labelDisplayHtml="display:none;";var required=elt.attr("required"),requiredStart="",requiredBalise="";required&&(requiredStart='<span style="color:red;">*</span>',requiredBalise="required");var tips=elt.attr("oda-input-select-tips"),tipsHtml="";tips&&(tipsHtml=$.Oda.I8n.getByString(tips));var disabled=elt.attr("disabled"),disabledBalise="";disabled&&(disabledBalise="disabled");var html=$.Oda.Display.TemplateHtml.create({template:"oda-widget-input-select-tpl",scope:{id:name,name:name,label:labelTrad,labelDisplay:labelDisplayHtml,requiredStart:requiredStart,requiredBalise:requiredBalise,disabledBalise:disabledBalise,tips:tipsHtml}});$(this).html(html)},attributeChangedCallback:function(attrName,oldValue,newValue){var elt=$(this),name=elt.attr("oda-input-select-name"),$select=$("#"+name),value=elt.attr("oda-input-select-value");switch(value||(value=""),attrName){case"oda-input-select-availables":$.Oda.Display.Widget.refreshAvailablesOfSelect({elt:this});break;case"oda-input-select-value":$select.val(value);break;case"disabled":null===oldValue?$select.attr("disabled",""):$select.removeAttr("disabled")}},attachedCallback:function(){$.Oda.Display.Widget.refreshAvailablesOfSelect({elt:this});var elt=$(this),name=elt.attr("oda-input-select-name"),required=elt.attr("required"),$inputSelect=$("#"+name);required?""!==$inputSelect.val()?($inputSelect.data("isOk",!0),$inputSelect.css("border-color","#04B404")):($inputSelect.data("isOk",!1),$inputSelect.css("border-color","#FF0000")):($inputSelect.data("isOk",!0),$inputSelect.css("border-color","#04B404")),$inputSelect.change(function(e){var $elt=$(this);required?""!==$elt.val()?($elt.data("isOk",!0),$elt.css("border-color","#04B404")):($elt.data("isOk",!1),$elt.css("border-color","#FF0000")):($elt.data("isOk",!0),$elt.css("border-color","#04B404")),$.Oda.Scope.Gardian.findByElt({id:e.target.id})})},detachedCallback:function(){}})}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.loadSelectInput: "+er.message),null}},loadLoading:function(){try{$.Oda.Display.Polyfill.createHtmlElement({name:"oda-loading",createdCallback:function(){var html=($(this),$.Oda.Display.TemplateHtml.create({template:"oda-loading-tpl"}));$(this).html(html)},attributeChangedCallback:function(attrName,oldValue,newValue){},attachedCallback:function(){},detachedCallback:function(){}})}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.loadLoading: "+er.message),null}},loadLabel:function(){try{$.Oda.Display.Polyfill.createHtmlElement({name:"oda-label",createdCallback:function(){var $elt=$(this),name=$elt.attr("oda-label-name");if(name){if($.Oda.Context.window.document.getElementById(name))throw new Error("Id:'"+name+"' already exist");if($.Oda.Context.window.document.getElementsByName(name).length>0)throw new Error("Name:'"+name+"' already exist");$elt.attr("id",name),$elt.attr("name",name)}$.Oda.Display.Widget.calcLabel($elt),$.Oda.Event.addListener({name:"oda-language-changed",callback:function(e){$.Oda.Display.Widget.calcLabel($elt,e.detail.new)}})},attributeChangedCallback:function(attrName,oldValue,newValue){var $elt=$(this);switch(attrName){case"oda-label-value":case"oda-label-group":case"oda-label-lang":case"oda-label-default-lang":case"oda-label-variables":$.Oda.Display.Widget.calcLabel($elt)}},attachedCallback:function(){},detachedCallback:function(){}})}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.loadLabel: "+er.message),null}},calcLabel:function($elt,newLanguage){try{var value=$elt.attr("oda-label-value");$.Oda.Log.debug("Oda label calc: "+value);var group=$elt.attr("oda-label-group"),lang=$elt.attr("oda-label-lang");!lang&&newLanguage&&(lang=newLanguage);var defaultLang=$elt.attr("oda-label-default-lang"),variables=$elt.attr("oda-label-variables");if(group){if(variables)try{variables=new Function("return "+variables)()}catch(e){throw new Error("Widget oda-label for value:'"+value+"' => Syntaxe of variables not correct JSON")}var inputs={defaultLang:defaultLang,forced:lang,variables:variables},labelTrad=$.Oda.I8n.get(group,value,inputs)}else var labelTrad=$.Oda.I8n.getByString(value,newLanguage);$elt.html(labelTrad)}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.calcLabel: "+er.message),null}},loadAvatar:function(){try{$.Oda.Display.Polyfill.createHtmlElement({name:"oda-avatar",createdCallback:function(){var $elt=$(this),name=$elt.attr("oda-avatar-name");if($.Oda.Context.window.document.getElementById(name)||!name)throw new Error("Id:'"+name+"' already exist");$.Oda.Display.Widget.setImageAvatar($elt)},attributeChangedCallback:function(attrName,oldValue,newValue){var $elt=$(this);switch(attrName){case"oda-avatar-user":$.Oda.Display.Widget.setImageAvatar($elt)}},attachedCallback:function(){},detachedCallback:function(){}})}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.loadAvatar: "+er.message),null}},setImageAvatar:function($elt){try{var name=$elt.attr("oda-avatar-name"),user=$elt.attr("oda-avatar-user"),height=$elt.attr("oda-avatar-height"),width=$elt.attr("oda-avatar-width"),codeUser=""===$.Oda.Session.code_user?"noUser":$.Oda.Session.code_user;user&&""!==user&&(codeUser=user);var divHeight,imgHeight,imgHeightDec,src=$.Oda.Context.rest+"vendor/happykiller/oda/resources/api/avatar/"+codeUser+"?mili"+$.Oda.Tooling.getMilise();height?(divHeight=height,imgHeight=$.Oda.Tooling.arrondir(height/1.5,0),imgHeightDec=$.Oda.Tooling.arrondir(imgHeight/2,0)):(divHeight=100,imgHeight=67,imgHeightDec=34),src+="&h="+divHeight;var divWidth,imgWidth,imgWidthDec;width?(divWidth=width,imgWidth=$.Oda.Tooling.arrondir(width/1.5,0),imgWidthDec=$.Oda.Tooling.arrondir(imgWidth/2,0)):(divWidth=100,imgWidth=67,imgWidthDec=34),src+="&w="+divWidth;var html=$.Oda.Display.TemplateHtml.create({template:"oda-avatar-tpl",scope:{src:src,name:name,height:divHeight,imgHeight:imgHeight,imgHeightDec:imgHeightDec,width:divWidth,imgWidth:imgWidth,imgWidthDec:imgWidthDec}});$elt.html(html)}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.setImageAvatar: "+er.message),null}},loadGuidance:function(){try{$(document).on("click",".popover .close",function(){$(this).parents(".popover").popover("hide")}),$(document).on("click",".popover .guidance-next",function(){var $elt=$(this),id=$elt.data("id");$elt.parents(".popover").popover("hide");var guidanceStorage=$.Oda.Storage.get("ODA-GUIDANCE-"+$.Oda.Session.code_user);guidanceStorage&&(guidanceStorage[id].status="read",$.Oda.Storage.set("ODA-GUIDANCE-"+$.Oda.Session.code_user,guidanceStorage)),$.Oda.Guidance.run()}),$(document).on("click",".popover .guidance-read",function(){var $elt=$(this),id=$elt.data("id"),guidanceStorage=$.Oda.Storage.get("ODA-GUIDANCE-"+$.Oda.Session.code_user);guidanceStorage&&(guidanceStorage[id].status="read",$.Oda.Storage.set("ODA-GUIDANCE-"+$.Oda.Session.code_user,guidanceStorage)),$elt.parents(".popover").popover("hide")}),$.Oda.Display.Polyfill.createHtmlElement({name:"oda-guidance",createdCallback:function(){$(this)},attributeChangedCallback:function(attrName,oldValue,newValue){$(this)},attachedCallback:function(){var $elt=$(this),id=$elt.attr("oda-guidance-id");$.Oda.Log.debug("Oda-guidance creation: "+id);var location=$elt.attr("oda-guidance-location");location||(location="auto");var next=$elt.attr("oda-guidance-next"),title=$elt.attr("oda-guidance-title");$elt.attr("class","oda-guidance");var $target=$("#"+id);if($target.exists()){var strHtml=$elt.html();-1===strHtml.indexOf("<")&&(strHtml='<oda-label oda-label-value="'+strHtml+'"/>'),strHtml+='<p style="text-align:center;"><a href="#" class="btn btn-info btn-xs guidance-'+(next?"next":"read")+'" data-id="'+id+'"><oda-label oda-label-value="guidance-read" oda-label-group="oda-main"/></a></p>';var strTitle="";strTitle=title?'<oda-label oda-label-value="'+title+'"/>':'<oda-label oda-label-value="guidance" oda-label-group="oda-main"/>',strTitle+='<a href="#" class="close" data-dismiss="alert">×</a>',$target.popover({trigger:"manual",placement:location,html:!0,title:strTitle,content:strHtml})}},detachedCallback:function(){}})}catch(er){return $.Oda.Log.error("$.Oda.Display.Widget.loadGuidance: "+er.message),null}}}},Tooling:{timerDebounce:null,timerThrottle:null,lastThrottle:null,checkParams:function(p_params,p_def){try{var params=$.Oda.Tooling.clone(p_params),param_return={};for(var key in p_def){if(null===p_def[key]){if(void 0===params[key])throw{name:"Parameter missing",level:"Show Stopper",message:"Param : "+key+" missing",htmlMessage:"Param : "+key+" missing",toString:function(){return this.name+": "+this.message}};param_return[key]=params[key]}else void 0===params[key]?param_return[key]=p_def[key]:param_return[key]=params[key];delete params[key]}for(var key in params)param_return[key]=params[key];return param_return}catch(er){return $.Oda.Log.error("$.Oda.Tooling.checkParams : "+er.message),null}},urlDownloadFromServerResources:function(p_params){try{return $.Oda.Context.rest+"vendor/happykiller/oda/resources/script/download.php&fic=../../../../../../../resources/"+p_params.strPath}catch(er){return $.Oda.Log.error("$.Oda.Tooling.urlDownloadFromServerResources : "+er.message),null}},timeout:function(func,time,arg){try{return setTimeout(func,time,arg),this}catch(er){return $.Oda.Log.error("$.Oda.Tooling.timeout : "+er.message),null}},arrondir:function(p_value,p_precision){try{var coef=Math.pow(10,p_precision);return 0!==coef?Math.round(p_value*coef)/coef:Math.round(p_value)}catch(er){return $.Oda.Log.error("$.Oda.Tooling.arrondir : "+er.message),null}},clone:function(p_params){try{if(null===p_params||"object"!=typeof p_params)return p_params;var copy=p_params.constructor();for(var attr in p_params)p_params.hasOwnProperty(attr)&&(copy[attr]=p_params[attr]);return copy}catch(er){return $.Oda.Log.error("$.Oda.Tooling.clone : "+er.message),null}},deepEqual:function(elt1,elt2){try{if("object"==typeof elt1&&null!==elt1&&"object"==typeof elt2&&null!==elt2){if(Object.keys(elt1).length!==Object.keys(elt2).length)return!1;for(var prop in elt1){if(!elt2.hasOwnProperty(prop))return!1;if(!$.Oda.Tooling.deepEqual(elt1[prop],elt2[prop]))return!1}return!0}return elt1===elt2}catch(er){return $.Oda.Log.error("$.Oda.Tooling.deepEqual : "+er.message),null}},debounce:function(callback,delay){try{var args=arguments,context=this;return clearTimeout($.Oda.Tooling.timerDebounce),$.Oda.Tooling.timerDebounce=setTimeout(function(){callback.apply(context,args)},delay),this}catch(er){return $.Oda.Log.error("$.Oda.Tooling.debounce : "+er.message),null}},decodeHtml:function(html){try{return $("<div/>").html(html).text()}catch(er){return $.Oda.Log.error("$.Oda.Tooling.decodeHtml : "+er.message),null}},findBetweenWords:function(p_params){try{var listReturn=[],r=new RegExp(p_params.first+"(.*?)"+p_params.last,"gm"),list=p_params.str.match(r);for(var indice in list)listReturn[indice]=list[indice].replace(p_params.first,"").replace(p_params.last,"");return listReturn}catch(er){return $.Oda.Log.error("$.Oda.Tooling.findBetweenWords : "+er.message),null}},replaceAll:function(p_params){try{if(void 0===p_params.str)throw new Error('Parameter "str" for find: "'+p_params.find+'" is missing in params of $.Oda.Tooling.replaceAll');if(void 0===p_params.find||""===p_params.find)throw new Error('Parameter "find" for by:"'+p_params.by+'" is missing in params of $.Oda.Tooling.replaceAll');if(void 0===p_params.by)throw new Error('Parameter "by" for find: "'+p_params.find+'" is missing in params of $.Oda.Tooling.replaceAll');if(""===p_params.str)return p_params.str;if(""===p_params.find)return p_params.str;var opt="g";p_params.hasOwnProperty("ignoreCase")&&p_params.ignoreCase&&(opt="gi");var strFind=p_params.find.replace(/([.?*+^$[\]\\(){}|-])/gi,"\\$1"),re=new RegExp(strFind,opt);return p_params.str.replace(re,p_params.by)}catch(er){return $.Oda.Log.error("$.Oda.Tooling.replaceAll : "+er.message),null}},clearSlashes:function(string){try{return string.toString().replace(/\/$/,"").replace(/^\//,"")}catch(er){return $.Oda.Log.error("$.Oda.Tooling.clearSlashes : "+er.message),null}},getLangBrowser:function(p_params){try{var lang="";if(!$.Oda.Tooling.isUndefined(navigator.language))switch(!0){case navigator.language.includes("fr"):lang="fr";break;case navigator.language.includes("en"):lang="en";break;case navigator.language.includes("es"):lang="es";break;case navigator.language.includes("it"):lang="it";break;default:lang=navigator.language}return lang}catch(er){return $.Oda.Log.error("$.Oda.Tooling.getLangBrowser : "+er.message),null}},getListValeurPourAttribut:function(p_obj,p_attribut,p_type){try{var retour=[];for(var indice in p_obj)for(var key in p_obj[indice])if(key===p_attribut)if(void 0!==p_type){var valeur=null;valeur="int"===p_type?parseInt(p_obj[indice][key]):"float"===p_type?parseFloat(p_obj[indice][key]):new p_type(p_obj[indice][key]),retour[retour.length]=valeur}else retour[retour.length]=p_obj[indice][key];return retour}catch(er){return $.Oda.Log.error("$.Oda.Tooling.getListValeurPourAttribut : "+er.message),null}},getTypeOfVar:function(v){try{var response=Object.prototype.toString.call(v);return response.substring(8,response.length-1)}catch(er){return $.Oda.Log.error("$.Oda.Tooling.getTypeOfVar : "+er.message),null}},isInArray:function(p_value,p_array){try{var boolRetour=!1;for(var indice in p_array)if($.Oda.Tooling.deepEqual(p_value,p_array[indice])){boolRetour=!0;break}return boolRetour}catch(er){return $.Oda.Log.error("$.Oda.Tooling.isInArray : "+er.message),null}},isUndefined:function(p_object){try{var boolReturn=!0;return void 0!==p_object&&(boolReturn=!1),boolReturn}catch(er){return $.Oda.Log.error("$.Oda.Tooling.isUndefined : "+er.message),null}},getMilise:function(){try{return(new Date).getTime()}catch(er){return $.Oda.Log.error("$.Oda.Tooling.getMilise : "+er.message),null}},getParameterGet:function(p){try{var result={},tableau=decodeURI(p.url).split("?");if(tableau.length>1){tableau=tableau[1],tableau=tableau.split("&");for(var indice in tableau){var tmp=tableau[indice].split("=");result[tmp[0]]=tmp[1]}}return result}catch(er){return $.Oda.Log.error("$.Oda.Tooling.getParameterGet : "+er.message),null}},getParamsLibrary:function(p_params){try{var listParams={};return $.each&&$("script[src*='"+p_params.library+"']").each(function(index,value){var src=$(value).attr("src");listParams=$.Oda.Tooling.getParameterGet({url:src})}),listParams}catch(er){return $.Oda.Log.error("$.Oda.Tooling.getParamsLibrary : "+er.message),null}},objectSize:function(obj){try{var key,size=0;for(key in obj)obj.hasOwnProperty(key)&&size++;return size}catch(er){return $.Oda.Log.error("$.Oda.Tooling.objectSize : "+er.message),null}},objDataTableFromJsonArray:function(p_JsonArray){try{var objRetour={statut:"ok"},arrayEntete={},i=0;for(var key in p_JsonArray[0])arrayEntete[key]=i,i++;objRetour.entete=arrayEntete;var arrayData=[];for(var indice in p_JsonArray){var subArrayData=[];for(var key in p_JsonArray[indice])subArrayData[subArrayData.length]=p_JsonArray[indice][key];arrayData[arrayData.length]=subArrayData}return objRetour.data=arrayData,objRetour}catch(er){$.Oda.Log.error("$.Oda.Tooling.objDataTableFromJsonArray : "+er.message);var objRetour={statut:"ko"};return objRetour}},order:function(p_params){try{var clone=this.clone(p_params.collection);return this.orderInter({collectionOri:clone,collectionDest:[],compare:p_params.compare})}catch(er){return $.Oda.Log.error("$.Oda.Tooling.order : "+er.message),null}},orderInter:function(p_params){try{if(p_params.collectionOri.length>0){var min={value:null,index:null};for(var index in p_params.collectionOri){var elt=p_params.collectionOri[index];if(null===min.value)min.value=elt,min.index=parseInt(index);else{1===p_params.compare(min.value,elt)&&(min.value=elt,min.index=parseInt(index))}}return p_params.collectionOri.splice(min.index,1),p_params.collectionDest.push(min.value),this.orderInter({collectionOri:p_params.collectionOri,collectionDest:p_params.collectionDest,compare:p_params.compare})}return p_params.collectionDest}catch(er){return $.Oda.Log.error("$.Oda.Tooling.orderInter : "+er.message),null}},pad2:function(number){try{return"integer"!=typeof number&&(number=parseInt(number)),(number<10?"0":"")+number}catch(er){return $.Oda.Log.error("$.Oda.Tooling.pad2 : "+er.message),null}},postResources:function(params){try{var strUrl=$.Oda.Context.rest+"vendor/happykiller/oda/resources/script/postResources.php?path="+params.folder;if(""!==params.idInput){var inputElement=$("#"+params.idInput),files=inputElement[0].files,data=new FormData;$.each(files,function(i,file){void 0!==params.names?void 0!==params.names[i]&&data.append(params.names[i],file):data.append(file.name,file)});$.ajax({url:strUrl,data:data,cache:!1,contentType:!1,processData:!1,dataType:"json",type:"POST",success:function(p_resultat,p_statut){params.callback(p_resultat.data)},error:function(p_resultat,p_statut,p_erreur){params.callback({error:p_erreur})}})}else $.Oda.Log.error("Erreur pas d'élement selectionné.");return this}catch(er){return $.Oda.Log.error("$.Oda.Tooling.postResources : "+er.message),null}},throttle:function(callback,delay){try{var now=+new Date,context=this,args=arguments;return $.Oda.Tooling.lastThrottle&&now<$.Oda.Tooling.lastThrottle+delay?(clearTimeout($.Oda.Tooling.timerThrottle),$.Oda.Tooling.timerThrottle=setTimeout(function(){callback.apply(context,args),$.Oda.Tooling.lastThrottle=now},delay)):(callback.apply(context,args),$.Oda.Tooling.lastThrottle=now),this}catch(er){return $.Oda.Log.error("$.Oda.Tooling.throttle : "+er.message),null}},detectBrower:function(){try{var browser,version,mobile,os,osversion,bit,ua=window.navigator.userAgent,platform=window.navigator.platform;if(/MSIE/.test(ua))browser="Internet Explorer",/IEMobile/.test(ua)&&(mobile=1),version=/MSIE \d+[.]\d+/.exec(ua)[0].split(" ")[1];else if(/Trident/.test(ua)){browser="Internet Explorer";var re=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");null!=re.exec(ua)&&(version=RegExp.$1)}else/Chrome/.test(ua)?(/CrOS/.test(ua)&&(platform="CrOS"),browser="Chrome",version=/Chrome\/[\d\.]+/.exec(ua)[0].split("/")[1]):/Opera/.test(ua)?(browser="Opera",(/mini/.test(ua)||/Mobile/.test(ua))&&(mobile=1)):/Android/.test(ua)?(browser="Android Webkit Browser",mobile=1,os=/Android\s[\.\d]+/.exec(ua)[0]):/Firefox/.test(ua)?(browser="Firefox",/Fennec/.test(ua)&&(mobile=1),version=/Firefox\/[\.\d]+/.exec(ua)[0].split("/")[1]):/Safari/.test(ua)&&(browser="Safari",(/iPhone/.test(ua)||/iPad/.test(ua)||/iPod/.test(ua))&&(os="iOS",mobile=1));return version||(version=/Version\/[\.\d]+/.exec(ua),version=version?version[0].split("/")[1]:/Opera\/[\.\d]+/.exec(ua)[0].split("/")[1]),"MacIntel"===platform||"MacPPC"===platform?(os="Mac OS X",osversion=/10[\.\_\d]+/.exec(ua)[0],/[\_]/.test(osversion)&&(osversion=osversion.split("_").join("."))):"CrOS"===platform?os="ChromeOS":"Win32"===platform||"Win64"==platform?(os="Windows",bit=platform.replace(/[^0-9]+/,"")):!os&&/Android/.test(ua)?os="Android":!os&&/Linux/.test(platform)?os="Linux":!os&&/Windows/.test(ua)&&(os="Windows"),$.Oda.Context.window.ui={browser:browser,version:version,mobile:mobile,os:os,osversion:osversion,bit:bit},this}catch(er){return $.Oda.Log.error("$.Oda.Tooling.detectBrower : "+er.message),null}},isOdaConpatible:function(){try{var boolRetour=!0;return"Internet Explorer"===$.Oda.Context.window.ui.browser&&parseFloat($.Oda.Context.window.ui.version)<11&&(console.error("Oda fatal error: Internet Explorer before 11 not supported."),boolRetour=!1),document.registerElement||(console.error("Oda fatal error: Webcomposant not supported."),boolRetour=!1,"Firefox"===$.Oda.Context.window.ui.browser&&(console.log("You can activate Webcomposant: https://developer.mozilla.org/en-US/docs/Web/Web_Components#Enabling_Web_Components_in_Firefox"),console.log("'about:config' in url, and activate 'dom.webcomponents.enabled' by double click."))),boolRetour}catch(er){return $.Oda.Log.error("$.Oda.Tooling.isOdaConpatible : "+er.message),null}},merge:function(params){try{var objReturn=this.clone(params.default);if(Array.isArray(objReturn)){var defaultEltArray=objReturn[0];objReturn=[];for(var index in params.source)objReturn.push(this.merge({default:defaultEltArray,source:params.source[index]}))}else if(null!==objReturn&&void 0!==objReturn&&objReturn.constructor===Object){for(var key in objReturn)null!==params.source&&void 0!==params.source&&void 0!==params.source[key]&&(objReturn[key]=this.merge({default:objReturn[key],source:params.source[key]}));for(var key in params.source)objReturn.hasOwnProperty(key)||(objReturn[key]=params.source[key])}else null!==params.source&&(objReturn=params.source);return objReturn}catch(er){return $.Oda.Log.error("$.Oda.Tooling.merge : "+er.message),null}},filter:function(params){try{if(!(params.src instanceof Array))throw{name:"Wrong type of src",level:"Show Stopper",message:"src is not an array",htmlMessage:"src is not an array",toString:function(){return this.name+": "+this.message}};var tabReturn=[];if(params.condition instanceof Function)for(var index in params.src){var elt=params.src[index];params.condition(elt)&&tabReturn.push(elt)}else{if(!(params.condition instanceof Object))throw{name:"Wrong type of condition",level:"Show Stopper",message:"condition is not an object or function",htmlMessage:"condition is not an object or function",toString:function(){return this.name+": "+this.message}};for(var index in params.src){var elt=params.src[index],gardian=!1;for(var keyCondition in params.condition){var conditionAttribute=params.condition[keyCondition];elt.hasOwnProperty(keyCondition)&&elt[keyCondition]===conditionAttribute&&(gardian=!0)}gardian&&tabReturn.push(elt)}}return tabReturn}catch(er){return $.Oda.Log.error("$.Oda.Tooling.filter : "+er.message),null}},jsonToStringHtml:function(p){try{var str=JSON.stringify(p.json);return str=$.Oda.Tooling.replaceAll({str:str,find:"'",by:"'"}),str=$.Oda.Tooling.replaceAll({str:str,find:'"',by:"'"})}catch(er){return $.Oda.Log.error("$.Oda.Tooling.jsonToStringHtml: "+er.message),null}},stringToOdaCrypt:function(str){try{for(var strOdaCrypt="",i=0;i<str.length;i++)strOdaCrypt+=""+str.charCodeAt(i).toString(16);return strOdaCrypt}catch(er){return $.Oda.Log.error("$.Oda.Tooling.stringToOdaCrypt: "+er.message),null}},odaCryptToString:function(strOdaCrypt){try{for(var hex=strOdaCrypt.toString(),str="",i=0;i<hex.length;i+=2)str+=String.fromCharCode(parseInt(hex.substr(i,2),16));return str}catch(er){return $.Oda.Log.error("$.Oda.Tooling.odaCryptToString: "+er.message),null}}},I8n:{datas:[],get:function(p_group,p_tag,options){try{var returnvalue="Not define";if(void 0!==options&&void 0!==options.forced)for(var grpId in $.Oda.I8n.datas){var grp=$.Oda.I8n.datas[grpId];if(grp.groupName===p_group&&grp.hasOwnProperty(options.forced)&&grp[options.forced].hasOwnProperty(p_tag)){if(returnvalue=grp[options.forced][p_tag],void 0!==options&&void 0!==options.variables)for(var key in options.variables)returnvalue=$.Oda.Tooling.replaceAll({str:returnvalue,find:"{{"+key+"}}",by:options.variables[key]});break}}else for(var grpId in $.Oda.I8n.datas){var grp=$.Oda.I8n.datas[grpId];if(grp.groupName===p_group&&grp.hasOwnProperty($.Oda.Session.userInfo.locale)&&grp[$.Oda.Session.userInfo.locale].hasOwnProperty(p_tag)){if(returnvalue=grp[$.Oda.Session.userInfo.locale][p_tag],void 0!==options&&void 0!==options.variables)for(var key in options.variables)returnvalue=$.Oda.Tooling.replaceAll({str:returnvalue,find:"{{"+key+"}}",by:options.variables[key]});break}}if("Not define"===returnvalue&&void 0!==options&&void 0!==options.defaultLang)for(var grpId in $.Oda.I8n.datas){var grp=$.Oda.I8n.datas[grpId];if(grp.groupName===p_group&&grp.hasOwnProperty(options.defaultLang)&&grp[options.defaultLang].hasOwnProperty(p_tag)){if(returnvalue=grp[options.defaultLang][p_tag],void 0!==options&&void 0!==options.variables)for(var key in options.variables)returnvalue=$.Oda.Tooling.replaceAll({str:returnvalue,find:"{{"+key+"}}",by:options.variables[key]});break}}return returnvalue}catch(er){return $.Oda.Log.error("$.Oda.I8n.get: "+er.message),null}},getByString:function(tag,lang){try{var returnvalue=tag,tab=tag.split(".");if(2===tab.length){var tmp=$.Oda.I8n.get(tab[0],tab[1],{forced:lang});"Not define"!==tmp&&(returnvalue=tmp)}return returnvalue}catch(er){return $.Oda.Log.error("$.Oda.I8n.getByString: "+er.message),null}},getByGroupName:function(groupName){try{var returnvalue="Not define";for(var grpId in $.Oda.I8n.datas){var grp=$.Oda.I8n.datas[grpId];if(grp.groupName===groupName&&grp.hasOwnProperty($.Oda.Session.userInfo.locale)){returnvalue=grp[$.Oda.Session.userInfo.locale];break}}return returnvalue}catch(er){return $.Oda.Log.error("$.Oda.I8n.getByGroupName: "+er.message),null}},watchLanguage:function(){try{return $.Oda.I8n.notifChangeExist||($.Oda.I8n.notifChangeExist=!0,$.Oda.Event.addListener({name:"oda-language-changed",callback:function(e){$.Oda.Log.debug("Language change on "+e.detail.event+" from: "+e.detail.old+" for:"+e.detail.new)}})),$.Oda.watch("Session",function(id,oldval,newval){return oldval.userInfo.locale!==newval.userInfo.locale&&$.Oda.Event.send({name:"oda-language-changed",data:{event:"Session",old:oldval.userInfo.locale,new:newval.userInfo.locale}}),newval}),$.Oda.Session.watch("userInfo",function(id,oldval,newval){return oldval.locale!==newval.locale&&$.Oda.Event.send({name:"oda-language-changed",data:{event:"userInfo",old:oldval.locale,new:newval.locale}}),newval}),$.Oda.Session.userInfo.watch("locale",function(id,oldval,newval){return oldval!==newval&&$.Oda.Event.send({name:"oda-language-changed",data:{event:"locale",old:oldval,new:newval}}),newval}),this}catch(er){return $.Oda.Log.error("$.Oda.I8n.watchLanguage: "+er.message),null}}},Security:{auth:function(p_params){try{return $.Oda.Log.debug("$.Oda.Security.auth begin."),$.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/session/",{type:"post",callback:function(response){if(""!==response.strErreur)$.Oda.Storage.remove("ODA-SESSION"),$.Oda.Display.Notification.warning(response.strErreur);else{var code_user=response.data.code_user.toUpperCase(),key=response.data.keyAuthODA,session={code_user:code_user,key:key};$.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/user/current",{callback:function(response){if(""===response.strErreur){var userInfo={locale:response.data.langue,lastName:response.data.nom,firstName:response.data.prenom,mail:response.data.mail,profile:response.data.profile,profileLabel:response.data.labelle,showTooltip:response.data.montrer_aide_ihm};session.userInfo=userInfo,session.id=response.data.id_user,$.Oda.Storage.set("ODA-SESSION",session,43200),$.Oda.Session=session,$.Oda.I8n.watchLanguage(),$.Oda.Security.loadRight({callback:function(){$.Oda.Router.routerExit=!1,p_params.reload&&$.Oda.Router.navigateTo()}})}else $.Oda.Storage.remove("ODA-SESSION"),$.Oda.Display.Notification.warning(response.strErreur),$.Oda.Router.routerExit=!1,p_params.reload&&$.Oda.Router.navigateTo()}},{keyAuthODA:key})}}},{userCode:p_params.login,password:p_params.mdp}),this}catch(er){return $.Oda.Log.Log.error("$.Oda.Security.auth : "+er.message),null}},loadRight:function(p){try{$.Oda.Router.routesAllowed=$.Oda.Router.routesAllowedDefault.slice(0),$.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/navigation/right/",{callback:function(response){var datas=response.data;for(var indice in datas)if("1"!==datas[indice].id_categorie){var route=datas[indice].Lien;route=route.replace("api_page_",""),route=route.replace("page_",""),route=route.replace(".html",""),$.Oda.Router.routesAllowed.push(route)}p.callback()}})}catch(er){$.Oda.Log.error("$.Oda.Security.loadRight: "+er.message)}},logout:function(){try{
""!==$.Oda.Session.key?$.Oda.Interface.callRest($.Oda.Context.rest+"vendor/happykiller/oda/resources/api/session/"+$.Oda.Session.key,{type:"delete",callback:function(response){$.Oda.Storage.remove("ODA-CACHE-"+$.Oda.Session.code_user),$.Oda.Session=$.Oda.SessionDefault,$.Oda.I8n.watchLanguage(),$.Oda.Storage.remove("ODA-SESSION"),$.Oda.Display.MenuSlide.remove(),$.Oda.Display.Menu.remove(),$.Oda.Router.routes.auth.go()}}):($.Oda.Storage.remove("ODA-CACHE-"+$.Oda.Session.code_user),$.Oda.Session=$.Oda.SessionDefault,$.Oda.I8n.watchLanguage(),$.Oda.Storage.remove("ODA-SESSION"),$.Oda.Display.MenuSlide.remove(),$.Oda.Display.Menu.remove(),$.Oda.Router.routes.auth.go())}catch(er){$.Oda.Log.error("$.Oda.Security.logout: "+er.message)}}},Worker:{lib:function(){this.$Oda={Context:{rest:"$$REST$$"},Session:{code_user:"$$CODEUSER$$",key:"$$ODAKEY$$"},message:function(cmd,parameter){try{this.cmd=cmd,this.parameter=parameter}catch(er){$Oda.log("ERROR($Oda.message : "+er.message)}},log:function(msg){console.log(msg)},callRest:function(p_url,p_tabSetting,p_tabInput){try{var jsonAjaxParam={url:p_url,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"json",type:"GET"};p_tabInput.milis=this.getMilise(),p_tabInput.ctrl="OK",p_tabInput.keyAuthODA=this.Session.key,jsonAjaxParam.data=p_tabInput;null===p_tabSetting.functionRetour&&(!1,jsonAjaxParam.async=!1);for(var indice in p_tabSetting)jsonAjaxParam[indice]=p_tabSetting[indice];var v_retourSync=null,xhr_object=new XMLHttpRequest;switch(jsonAjaxParam.type){case"GET":case"get":var url=jsonAjaxParam.url+"?tag=1";for(var key in jsonAjaxParam.data){var param=jsonAjaxParam.data[key].toString();url+="&"+key+"="+param.replace(new RegExp("&","g"),"%26")}xhr_object.open(jsonAjaxParam.type,url,!1),xhr_object.send(null);break;case"POST":case"post":default:var params="tag=1";for(var key in jsonAjaxParam.data){var param=jsonAjaxParam.data[key].toString();params+="&"+key+"="+param.replace(new RegExp("&","g"),"%26")}xhr_object.open(jsonAjaxParam.type,jsonAjaxParam.url,!1),xhr_object.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhr_object.send(params)}switch(v_retourSync={strErreur:"No call",data:{},statut:4},jsonAjaxParam.dataType){case"json":v_retourSync=4===xhr_object.readyState&&200===xhr_object.status?JSON.parse(xhr_object.responseText):{strErreur:"$Oda.callRest : "+xhr_object.status+" "+xhr_object.statusText,data:{},statut:4};break;case"text":default:v_retourSync=4===xhr_object.readyState?xhr_object.responseText:"$Oda.callRest : "+xhr_object.status+" "+xhr_object.statusText}return delete self.xhr_object,v_retourSync}catch(er){var msg="ERROR($Oda.callRest) : "+er.message;return $Oda.log(msg),null}},getMilise:function(){try{return(new Date).getTime()}catch(er){return $Oda.log("ERROR($Oda.getMilise) : "+er.message),null}},arrondir:function(p_value,p_precision){try{var coef=Math.pow(10,p_precision);return 0!==coef?Math.round(p_value*coef)/coef:Math.round(p_value)}catch(er){return $Oda.log("ERROR($Oda.arrondir) : "+er.message),null}}}},message:function(cmd,parameter){try{this.cmd=cmd,this.parameter=parameter}catch(er){$.Oda.Log.error("$.Oda.Worker.message : "+er.message)}},initWorker:function(p_nameWorker,p_dataInit,p_functionCore,p_fonctionRetour){try{var strFunctionLib=$.Oda.Worker.lib.toString();strFunctionLib=strFunctionLib.substring(12),strFunctionLib=strFunctionLib.substring(0,strFunctionLib.length-1),strFunctionLib=strFunctionLib.replace("$$CODEUSER$$",$.Oda.Session.code_user),strFunctionLib=strFunctionLib.replace("$$ODAKEY$$",$.Oda.Session.key),strFunctionLib=strFunctionLib.replace("$$REST$$",$.Oda.Context.rest);var strFunctionCore=p_functionCore.toString();strFunctionCore=strFunctionCore.substring(12),strFunctionCore=strFunctionCore.substring(0,strFunctionCore.length-1);var blob=new Blob([strFunctionLib+strFunctionCore],{type:"application/javascript"}),monWorker=new Worker(window.URL.createObjectURL(blob));return monWorker.addEventListener("message",function(event){p_fonctionRetour(event.data)},!1),monWorker}catch(er){$.Oda.Log.error("$.Oda.Worker.initWorker : "+er.message)}},terminateWorker:function(p_worker){try{p_worker.terminate()}catch(er){$.Oda.Log.error("$.Oda.Worker.terminateWorker : "+er.message)}}},Guidance:{run:function(){try{$.Oda.Log.debug("$.Oda.Guidance.run.");var guidanceStorage=$.Oda.Storage.get("ODA-GUIDANCE-"+$.Oda.Session.code_user);guidanceStorage||(guidanceStorage={}),$("oda-guidance").each(function(){$elt=$(this);var id=$elt.attr("oda-guidance-id"),next=$elt.attr("oda-guidance-next");void 0===guidanceStorage[id]&&(guidanceStorage[id]={status:next?"next":"show"})}),$.Oda.Storage.set("ODA-GUIDANCE-"+$.Oda.Session.code_user,guidanceStorage);var gardianNext=!1;for(var key in guidanceStorage){var elt=guidanceStorage[key];if("show"===elt.status){var $elt=$("#"+key);$elt.next("div.popover:visible").length||$elt.popover("show")}else if("next"===elt.status&&!gardianNext){gardianNext=!0;var $elt=$("#"+key);$elt.next("div.popover:visible").length||$elt.popover("show")}}return this}catch(er){$.Oda.Log.error("$.Oda.Guidance.run: "+er.message)}}},Scope:{Gardian:{inventory:{},add:function(p_params){try{return $.Oda.Scope.Gardian.inventory[p_params.id]={listElt:p_params.listElt,function:p_params.function},p_params.function(),this}catch(er){return $.Oda.Log.error("$.Oda.Scope.Gardian.add : "+er.message),null}},remove:function(p_params){try{return $.each($.Oda.Scope.Gardian.inventory,function(key,value){delete $.Oda.Scope.Gardian.inventory[key]}),this}catch(er){return $.Oda.Log.error("$.Oda.Scope.Gardian.remove : "+er.message),null}},removeAll:function(){try{return $.Oda.Scope.Gardian.inventory={},this}catch(er){return $.Oda.Log.error("$.Oda.Scope.Gardian.removeAll : "+er.message),null}},findByElt:function(p_params){try{return $.each($.Oda.Scope.Gardian.inventory,function(key,value){$.Oda.Tooling.isInArray(p_params.id,value.listElt)&&value.function({elt:p_params.id})}),this}catch(er){return $.Oda.Log.error("$.Oda.Scope.Gardian.findByElt : "+er.message),null}}}},Storage:{version:"0.170303.00",ttl_default:86400,storageKey:"ODA__default__",isStorageAvaible:function(){try{var boolRetour=!1;return localStorage&&(boolRetour=!0),boolRetour}catch(er){return $.Oda.Log.error("Oda.Storage.isStorageAvaible : "+er.message),null}},set:function(p_key,p_value,p_ttl){try{var d=new Date,date=d.getTime(),ttl=0;void 0!==p_ttl&&(ttl=p_ttl);var compressed,storage={value:p_value,recordDate:date,ttl:ttl},data=JSON.stringify(storage);return compressed="undefined"!=typeof LZString?LZString.compressToUTF16(data):data,localStorage.setItem(this.storageKey+p_key,compressed),!0}catch(er){return $.Oda.Log.error("$.Oda.Storage.set : "+er.message),null}},get:function(p_key,p_default){try{var myValue=null,compressed=localStorage.getItem($.Oda.Storage.storageKey+p_key);if(null!==compressed){var data;data="undefined"!=typeof LZString?LZString.decompressFromUTF16(compressed):compressed;var myStorage=JSON.parse(data);if(myValue=myStorage.value,null!==myStorage.value&&0!==myStorage.ttl){(new Date).getTime()>myStorage.recordDate+1e3*myStorage.ttl&&(this.remove(p_key),myValue=null)}null===myValue&&void 0!==p_default&&(this.set(p_key,p_default),myValue=p_default)}else void 0!==p_default&&(this.set(p_key,p_default),myValue=p_default);return myValue}catch(er){return $.Oda.Log.error("$.Oda.Storage.get : "+er.message),null}},setTtl:function(p_key,p_ttl){try{var myReturn=!1,myStorage=localStorage.getItem($.Oda.Storage.storageKey+p_key);if(null!==myStorage){var data;data="undefined"!=typeof LZString?LZString.decompressFromUTF16(myStorage):myStorage;var value=JSON.parse(data),myReturn=$.Oda.Storage.set(p_key,value.value,p_ttl)}return myReturn}catch(er){return $.Oda.Log.error("$.Oda.Storage.setTtl : "+er.message),null}},getTtl:function(p_key){try{var myReturn=0,myStorage=localStorage.getItem($.Oda.Storage.storageKey+p_key);if(null!==myStorage){var data;data="undefined"!=typeof LZString?LZString.decompressFromUTF16(myStorage):myStorage;var value=JSON.parse(data),d=new Date,date=d.getTime();myReturn=value.recordDate+1e3*value.ttl-date}return myReturn}catch(er){return $.Oda.Log.error("$.Oda.Storage.getTtl : "+er.message),null}},remove:function(p_key){try{return localStorage.removeItem($.Oda.Storage.storageKey+p_key),!0}catch(er){return $.Oda.Log.error("$.Oda.Storage.setTtl : "+er.message),null}},reset:function(){try{for(var indice in localStorage)localStorage.removeItem(indice);return!0}catch(er){return $.Oda.Log.error("$.Oda.Storage.reset : "+er.message),null}},getIndex:function(p_filtre){try{var myReturn=[];for(var indice in localStorage){new RegExp($.Oda.Storage.storageKey+p_filtre,"gi").test(indice)&&myReturn.push(indice)}return myReturn}catch(er){return $.Oda.Log.error("$.Oda.Storage.getIndex : "+er.message),null}}},Router:{current:{route:"",args:[]},routes:{},routerExit:!1,routesAllowed:[],routeDependencies:[],routesAllowedDefault:[],MiddleWares:{},navigateTo:function(p_request){try{$.Oda.Display.Popup.closeAll(),$.Oda.Router.routerExit=!1,$.Oda.Tooling.isUndefined(p_request)&&(p_request=$.Oda.Router.current);for(var name in $.Oda.Router.routes)for(var indice in $.Oda.Router.routes[name].urls){var url=$.Oda.Router.routes[name].urls[indice];if(url===p_request.route)return $.Oda.Router.current=p_request,""!==$.Oda.Session.code_user&&$.Oda.Interface.addStat($.Oda.Session.code_user,$.Oda.Router.current.route,"request"),$.Oda.Router.routes[name].go(p_request),$("#wrapper").exists()&&$("#wrapper").removeClass("toggled"),this}return $.Oda.Log.error(p_request.route+" not found."),$.Oda.Router.routes[404].go(p_request),this}catch(er){return $.Oda.Log.error("$.Oda.Router.navigateTo : "+er.message),null}},addRoute:function(p_name,p_routeDef){try{return p_routeDef.hasOwnProperty("system")||(p_routeDef.system=!1),p_routeDef.go=function(p_request){$.Oda.Router.routerGo({routeDef:this,request:p_request})},p_routeDef.hasOwnProperty("middleWares")||(p_routeDef.middleWares=[]),p_routeDef.hasOwnProperty("dependencies")||(p_routeDef.dependencies=[]),$.Oda.Router.routes[p_name]=p_routeDef,this}catch(er){return $.Oda.Log.error("$.Oda.Router.addRoute : "+er.message),null}},addMiddleWare:function(p_name,p_midlleWareDef){try{return $.Oda.Router.MiddleWares[p_name]=p_midlleWareDef,$.Oda.Router.MiddleWares[p_name].name=p_name,this}catch(er){return $.Oda.Log.error("$.Oda.Router.addMiddleWare : "+er.message),null}},addDependencies:function(p_name,p_dependenciesLoad){try{return p_dependenciesLoad.name=p_name,$.Oda.Router.routeDependencies[p_name]=p_dependenciesLoad,this}catch(er){return $.Oda.Log.error("$.Oda.Router.addDependencies : "+er.message),null}},loadPartial:function(p_params){try{return $.get(p_params.routeDef.path,function(data){$("#"+$.Oda.Context.mainDiv).html(data),$("[oda-avatar-name=avatar]").attr("oda-avatar-user",$.Oda.Session.code_user),""!==$.Oda.Session.code_user&&$.Oda.Guidance.run()}).fail(function(){$.Oda.Log.error("$.Oda.Router.loadPartial : "+p_params.routeDef.path+" not found.")}),this}catch(er){return $.Oda.Log.error("$.Oda.Router.loadPartial : "+er.message),null}},startRooter:function(){try{$("#projectLabel").exists()&&$("#projectLabel").text($.Oda.Context.projectLabel),$("#"+$.Oda.Context.mainDiv).exists()||$(" body ").append('\x3c!-- content --\x3e<div id="'+$.Oda.Context.mainDiv+'"><oda-loading></oda-loading></div>');var hash=decodeURI($.Oda.Context.window.location.hash.substring(1).replace(/\?(.*)$/,"")),loc=$.Oda.Context.window.location+"",locationRacine=loc.replace(/#(.*)$/,"").replace(/\?(.*)$/,"")+"#",paramsGet=$.Oda.Tooling.getParameterGet({url:decodeURI($.Oda.Context.window.location)}),obj={Page:hash,Url:locationRacine};return $.Oda.Context.window.history.pushState(obj,obj.Page,obj.Url),$.Oda.Router.current={route:hash,args:paramsGet},this.navigateTo($.Oda.Router.current),this}catch(er){return $.Oda.Log.error("$.Oda.Router.startRooter : "+er.message),null}},routerGo:function(p_params){try{if($.Oda.Log.debug("RouterGo : "+p_params.routeDef.path),$("#"+$.Oda.Context.mainDiv).html("<oda-loading/>"),!p_params.routeDef.system){var urlRoute=$.Oda.Router.current.route,urlArg="";for(var key in $.Oda.Router.current.args)"getUser"!==$.Oda.Router.current.args[key]&&"getPass"!==$.Oda.Router.current.args[key]&&(urlArg+=""===urlArg?"?":"&",urlArg+=key+"="+$.Oda.Router.current.args[key]);$.Oda.Context.window.location.hash=urlRoute+urlArg;var decoded=$.Oda.Tooling.decodeHtml($.Oda.I8n.getByString(p_params.routeDef.title));$.Oda.Context.window.document.title=$.Oda.Context.projectLabel+" - "+decoded}var listDepends=[];for(var indice in p_params.routeDef.dependencies)listDepends=listDepends.concat($.Oda.Router.routeDependencies[p_params.routeDef.dependencies[indice]]);return $.Oda.Loader.load({depends:listDepends,functionFeedback:function(data){if(data.params.routeDef.middleWares.length>0)for(var indice in data.params.routeDef.middleWares)$.Oda.Router.MiddleWares[data.params.routeDef.middleWares[indice]]();if($.Oda.Router.routerExit&&!data.params.routeDef.system)return!0;$.Oda.Context.ModeExecution.scene&&""!==$.Oda.Session.code_user&&($.Oda.Display.MenuSlide.show(),$.Oda.Display.Menu.show()),$.Oda.Context.ModeExecution.message&&""!==$.Oda.Session.code_user&&$.Oda.Display.Message.show(),$.Oda.Scope.Gardian.removeAll(),$.Oda.Router.loadPartial({routeDef:data.params.routeDef})},functionFeedbackParams:{params:p_params}}),!0}catch(er){return $.Oda.Log.error("$.Oda.Router.routerGo : "+er.message),null}}},Google:{gapiStatuts:{zero:0,init:1,loaded:2,finish:3,fail:4},gapiStatut:0,gapi:null,clientId:"249758124548-fgt33dblm1r8jm0nh9snn53pkghpjtsu.apps.googleusercontent.com",apiKey:"PgCsKeWAsVGdOj3KjPn-JPS3",scopes:"https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email",trySessionAuth:0,methodeSessionAuthKo:null,methodeSessionAuthOk:null,sessionInfo:null,gaips:[],urlTokenInfo:"https://www.googleapis.com/oauth2/v1/tokeninfo",init:function(){try{switch($.Oda.Google.gapiStatut){case $.Oda.Google.gapiStatuts.zero:$.Oda.Google.gapiStatut=$.Oda.Google.gapiStatuts.init,$.getScript("https://apis.google.com/js/client.js?onload=handleClientLoad",function(){$.Oda.Google.handleClientLoad()});break;case $.Oda.Google.gapiStatuts.loaded:$.Oda.Log.debug("$.Oda.Google.init : already load.");break;default:$.Oda.Log.error("$.Oda.Google.init : client load fail.")}}catch(er){$.Oda.Log.error("$.Oda.Google.init :"+er.message)}},handleClientLoad:function(){try{gapi.hasOwnProperty("client")?($.Oda.Google.gapi=gapi,$.Oda.Google.gapiStatut=$.Oda.Google.gapiStatuts.loaded,$.Oda.Event.send({name:"oda-gapi-loaded"}),$.Oda.Log.debug("$.Oda.Google.handleClientLoad : finish.")):($.Oda.Log.debug("$.Oda.Google.handleClientLoad : waiting (gapi.client not loaded)"),$.Oda.Tooling.timeout($.Oda.Google.handleClientLoad,100))}catch(er){$.Oda.Log.error("$.Oda.Google.handleClientLoad :"+er.message)}},startSessionAuth:function(methodOk,methodKo){try{switch($.Oda.Tooling.isUndefined(methodOk)||($.Oda.Google.methodeSessionAuthOk=methodOk),$.Oda.Tooling.isUndefined(methodKo)||($.Oda.Google.methodeSessionAuthKo=methodKo),$.Oda.Google.gapiStatut){case $.Oda.Google.gapiStatuts.zero:$.Oda.Log.debug("$.Oda.Google.startSessionAuth : waiting (gapi not start)"),$.Oda.Google.init(),$.Oda.Event.addListener({name:"oda-gapi-loaded",callback:function(e){$.Oda.Google.startSessionAuth()}});break;case $.Oda.Google.gapiStatuts.loaded:$.Oda.Google.loadGapis([{api:"oauth2",version:"v2"}],$.Oda.Google.callbackAuthSession),$.Oda.Log.debug("$.Oda.Google.startSessionAuth : finish.");break;case $.Oda.Google.gapiStatuts.init:$.Oda.Log.debug("$.Oda.Google.startSessionAuth : waiting (gapi not loaded)"),$.Oda.Tooling.timeout($.Oda.Google.startSessionAuth,100);break;default:$.Oda.Log.error("$.Oda.Google.startSessionAuth : $.Oda.Google.gapi problem.")}}catch(er){$.Oda.Log.error("$.Oda.Google.startSessionAuth : "+er.message)}},loadGapis:function(tabApi,callbackFunction){try{if(tabApi.length>0){for(var indice in $.Oda.Google.gaips)if($.Oda.Google.gaips[indice].api===tabApi[0].api&&$.Oda.Google.gaips[indice].version===tabApi[0].version)return $.Oda.Log.debug("$.Oda.Google.loadGapis : Already ok pour "+tabApi[0].api+" en "+tabApi[0].version),tabApi.splice(0,1),$.Oda.Google.loadGapis(tabApi,callbackFunction),!0;$.Oda.Google.gapi.client.load(tabApi[0].api,tabApi[0].version,function(resp){void 0===resp?($.Oda.Google.gaips.push({api:tabApi[0].api,version:tabApi[0].version}),$.Oda.Log.debug("$.Oda.Google.loadGapis : Chargement ok pour "+tabApi[0].api+" en "+tabApi[0].version),tabApi.splice(0,1),$.Oda.Google.loadGapis(tabApi,callbackFunction)):$.Oda.Log.debug("$.Oda.Google.loadGapis : Chargement ko pour "+tabApi[0].api+" en "+tabApi[0].version+"("+resp.error.message+")")})}else $.Oda.Log.debug("$.Oda.Google.loadGapis : finish."),callbackFunction()}catch(er){$.Oda.Log.error("$.Oda.Google.loadGapis :"+er.message)}},callbackAuthSession:function(){try{$.Oda.Google.gapi.client.setApiKey($.Oda.Google.apiKey),$.Oda.Google.gapi.auth.authorize({client_id:$.Oda.Google.clientId,scope:$.Oda.Google.scopes,immediate:!0},$.Oda.Google.handleAuthResult),$.Oda.Log.debug("$.Oda.Google.callbackAuthSession finish.")}catch(er){$.Oda.Log.error("$.Oda.Google.callbackAuthSession :"+er.message)}},handleAuthResult:function(authResult){try{authResult&&!authResult.error&&void 0!==authResult.access_token?($.Oda.Google.sessionInfo=authResult,$.Oda.Google.methodeSessionAuthOk()):$.Oda.Google.methodeSessionAuthKo(),$.Oda.Log.debug("$.Oda.Google.handleAuthResult finish.")}catch(er){$.Oda.Log.error("$.Oda.Google.handleAuthResult :"+er.message)}},callServiceGoogleAuth:function(callMethodeOk){try{$.Oda.Google.methodeSessionAuthOk=callMethodeOk,$.Oda.Google.gapi.auth.authorize({client_id:$.Oda.Google.clientId,scope:$.Oda.Google.scopes,immediate:!1},$.Oda.Google.handleAuthResult),$.Oda.Log.debug("$.Oda.Google.callServiceGoogleAuth finish.")}catch(er){$.Oda.Log.error("$.Oda.Google.callServiceGoogleAuth :"+er.message)}},sessionState:function(p_params){try{var tabInput={access_token:$.Oda.Google.sessionInfo.access_token};$.Oda.Interface.callRest($.Oda.Google.urlTokenInfo,{callback:function(response){p_params.callback(response)}},tabInput);return this}catch(er){return $.Oda.Log.error("$.Oda.Google.sessionState : "+er.message),null}}},Log:{info:function(p_msg){try{return $.Oda.Context.console.info(p_msg),this}catch(er){return console.log("$.Oda.Log.info : "+er.message),null}},trace:function(p_msg){try{return $.Oda.Context.console.log(p_msg),this}catch(er){return console.log("$.Oda.Log.trace : "+er.message),null}},debug:function(p_msg){try{return($.Oda.Context.dev||$.Oda.Context.debug)&&$.Oda.Context.console.debug(p_msg),this}catch(er){return console.log("$.Oda.Log.debug : "+er.message),null}},error:function(p_msg){try{return $.Oda.Context.console.error(p_msg),$.Oda.Context.dev||$.Oda.Context.debug||$.Oda.Interface.traceLog({msg:p_msg}),this}catch(er){return console.log("$.Oda.Log.error : "+er.message),null}},warning:function(p_msg){try{return $.Oda.Context.console.warn(p_msg),this}catch(er){return console.log("$.Oda.Log.warning : "+er.message),null}}},Websocket:{tagJson:"odaTagJson:",connection:function(wsConn){that=this,that.wsConn=wsConn,that.wsConn.onopen=function(e){$.Oda.Log.debug("$.Oda.Websocket.connect: Connection success."),that.onConnect()},that.wsConn.onmessage=function(e){$.Oda.Log.debug("$.Oda.Websocket.connect: Message receive from "+e.origin);var data=e.data;if(e.data.startsWith($.Oda.Websocket.tagJson)){var tmpStr=$.Oda.Tooling.replaceAll({str:e.data,find:$.Oda.Websocket.tagJson,by:""});data=JSON.parse(tmpStr)}that.onMessage({origin:e.origin,data:data})},that.send=function(msg){var strMsg=msg;"string"!=typeof msg&&(strMsg=$.Oda.Websocket.tagJson+JSON.stringify(msg)),that.wsConn.send(strMsg)},that.onConnect=function(){},that.onMessage=function(e){}},connect:function(p){try{var protocol="ws://";"https:"!==window.location.protocol&&"file:"!==window.location.protocol||(protocol="wss://");var connStr=protocol+p.host+(""!==p.port&&null!==p.port?":"+p.port:"")+"/"+p.instance;return $.Oda.Log.debug("$.Oda.Websocket.connect to "+connStr),new $.Oda.Websocket.connection(new WebSocket(connStr))}catch(er){return $.Oda.Log.error("$.Oda.Websocket.connect: "+er.message),null}}}},$.Oda.Session=$.Oda.SessionDefault,$.Oda.I8n.watchLanguage(),$.Oda.Context.startDate=new Date,$.Oda.Tooling.detectBrower();var params=$.Oda.Tooling.getParamsLibrary({library:"Oda"});if(params.hasOwnProperty("modeExecution"))switch(params.modeExecution){case"full":$.Oda.Context.ModeExecution.app=!0,$.Oda.Context.ModeExecution.scene=!0,$.Oda.Context.ModeExecution.init=!0,$.Oda.Context.ModeExecution.notification=!0,$.Oda.Context.ModeExecution.message=!0,$.Oda.Context.ModeExecution.footer=!0,$.Oda.Context.ModeExecution.widget=!0;break;case"app":$.Oda.Context.ModeExecution.app=!0,$.Oda.Context.ModeExecution.init=!0,$.Oda.Context.ModeExecution.notification=!0,$.Oda.Context.ModeExecution.message=!0,$.Oda.Context.ModeExecution.footer=!0,$.Oda.Context.ModeExecution.widget=!0;break;case"mini":$.Oda.Context.ModeExecution.init=!0,$.Oda.Context.ModeExecution.notification=!0,$.Oda.Context.ModeExecution.message=!0,$.Oda.Context.ModeExecution.footer=!0}params.hasOwnProperty("vendorName")&&($.Oda.Context.vendorName=params.vendorName),params.hasOwnProperty("debug")&&($.Oda.Context.debug=params.debug),params.hasOwnProperty("dev")&&($.Oda.Context.dev=params.dev),params.hasOwnProperty("appLibName")&&($.Oda.Context.appLibName=params.appLibName),$.Oda.Context.ModeExecution.init&&($.Oda.Tooling.isOdaConpatible()?$.Oda.init():$("body").append('<p style="text-align:center;font-weight: bold;">Brower not compatible for Oda. Please check the console for more details.</p>'))}($||($={fn:{}}));